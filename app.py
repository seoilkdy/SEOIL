# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Tkinter: íŒŒì´ì¬ ê¸°ë³¸ GUI                                   # ì•±ì˜ ëª©ì /ë²”ì£¼ ì„¤ëª…
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ê°„ë‹¨í•œ ToDo ê´€ë¦¬ + í”„ë¦¬ì  í…Œì´ì…˜ íƒ€ì´ë¨¸ + ì‹¤ì‹œê°„ 'ì„±ê³¼ ë¦¬í¬íŠ¸' ëŒ€ì‹œë³´ë“œë¥¼ ì œê³µí•˜ëŠ” Tkinter ë°ìŠ¤í¬í†± ì•±ì´ë‹¤.  # New ìƒìœ„ ìš”ì•½

from dataclasses import dataclass  # dataclass ë°ì½”ë ˆì´í„°ë¡œ ìƒì„±ì/í‘œí˜„ ë“± ë³´ì¼ëŸ¬í”Œë ˆì´íŠ¸ ìë™ ìƒì„±
from datetime import date, datetime, timedelta  # ë‚ ì§œ(date), ë‚ ì§œì‹œê°„(datetime), ê¸°ê°„(timedelta)
from pathlib import Path  # ìš´ì˜ì²´ì œ ë¬´ê´€í•œ ê²½ë¡œ ì²˜ë¦¬
import time  # ë‹¨ì¡° ì¦ê°€ ì‹œê³„(time.monotonic) ì‚¬ìš© â†’ ì‹œìŠ¤í…œ ì‹œê°„ ë³€ê²½ ì˜í–¥ì„ ì•ˆ ë°›ëŠ” íƒ€ì´ë¨¸
import math  # ì˜¬ë¦¼/ë‚´ë¦¼, ë³´ê°„ ê³„ì‚° ë“±ì— ì‚¬ìš©
import sqlite3 as sql  # ë‚´ì¥ SQLite DBë¡œ ê°„ë‹¨ ì˜ì†í™”(íŒŒì¼ 1ê°œ)
import tkinter as tk  # Tkinter ê¸°ë³¸ ìœ„ì ¯
from tkinter import ttk, messagebox  # ttk(í˜„ëŒ€ì‹ ìŠ¤í‚¨), messagebox(ëª¨ë‹¬ ì•Œë¦¼/í™•ì¸)

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ìƒìˆ˜/í¬ë§·/ê³µìš© íŒ¨ë”©                                         # ìƒìˆ˜/ê³µìš© ê°’ ë¬¶ìŒ
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
DATE_FMT = "%Y-%m-%d"  # ë‚ ì§œ ë¬¸ìì—´ í˜•ì‹(ì˜ˆ: 2025-09-16) â€” DB/í‘œì‹œ í¬ë§·ì„ í†µì¼í•´ íŒŒì‹±ì˜¤ë¥˜ë¥¼ ì¤„ì„
STATUS_ICON = {0: "â˜", 1: "â³", 2: "âœ”"}  # ìƒíƒœì½”ë“œâ†’ì•„ì´ì½˜ ë§¤í•‘(ë¯¸ì™„/ì§„í–‰/ì™„ë£Œ)
STATUS_TEXT = {0: "ë¯¸ì™„ë£Œ", 1: "ì§„í–‰ì¤‘", 2: "ì™„ë£Œ"}  # ìƒíƒœì½”ë“œâ†’ì½ì„ ìˆ˜ ìˆëŠ” í…ìŠ¤íŠ¸
PAD6 = {"padx": 10, "pady": 6}  # grid/pack ê³µí†µ ì—¬ë°± í”„ë¦¬ì…‹(6)
PAD8 = {"padx": 10, "pady": 8}  # ê³µí†µ ì—¬ë°± í”„ë¦¬ì…‹(8)
# New ì•„ì´ì½˜/í…ìŠ¤íŠ¸ ë§¤í•‘ì„ í†µí•´ ë¦¬ìŠ¤íŠ¸, ìƒì„¸ íŒì—…, ë¦¬í¬íŠ¸ ë¬¸êµ¬ ë“± UI ì „ë°˜ì˜ í‘œí˜„ì„ ì¼ê´€ë˜ê²Œ ìœ ì§€í•œë‹¤.

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# DB ê²½ë¡œ ê³ ì •(ìŠ¤í¬ë¦½íŠ¸ í´ë”) + ëŒ€í™”í˜• í™˜ê²½ í´ë°±             # ì‹¤í–‰ í™˜ê²½ ì°¨ì´ì— ë”°ë¥¸ DB ê²½ë¡œ ë³´ì •
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
try:
    DB_PATH = str(Path(__file__).with_name("todo.db"))  # ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ê³¼ ê°™ì€ í´ë”ì— todo.db ìƒì„±/ì‚¬ìš©
except NameError:
    DB_PATH = "todo.db"  # __file__ì´ ì—†ëŠ” ì¸í„°í”„ë¦¬í„°/ë…¸íŠ¸ë¶ í™˜ê²½ì—ì„œëŠ” í˜„ì¬ ì‘ì—… í´ë”ì— ì €ì¥
# New __file__ ìœ ë¬´ì— ë”°ë¼ ê²½ë¡œ ì „ëµì„ ë¶„ê¸° â†’ ì–´ë””ì„œ ì‹¤í–‰í•´ë„ ë™ì¼í•œ íŒŒì¼ëª…ì„ ì“°ë„ë¡ ì•ˆì •í™”.

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ìœ í‹¸: ë‚ ì§œ íŒŒì‹± / ì°½ ì¤‘ì•™ ë°°ì¹˜                              # ìì£¼ ì“°ëŠ” í—¬í¼ í•¨ìˆ˜ ëª¨ìŒ
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
def parse_date(s: str) -> datetime:  # ë‚ ì§œ ë¬¸ìì—´ì„ datetimeìœ¼ë¡œ íŒŒì‹±í•˜ëŠ” í—¬í¼ ì‹œê·¸ë‹ˆì²˜
    """ë‚ ì§œ ë¬¸ìì—´(YYYY-MM-DD)ì„ datetime ê°ì²´ë¡œ ë³€í™˜."""  # í˜•ì‹ ì˜¤ë¥˜ ì‹œ ì˜ˆì™¸ë¥¼ ë°œìƒì‹œì¼œ í˜¸ì¶œë¶€ì—ì„œ UX ì²˜ë¦¬
    return datetime.strptime(s, DATE_FMT)  # í˜•ì‹ ë¶ˆì¼ì¹˜ ì‹œ ValueError ë°œìƒ â†’ í˜¸ì¶œë¶€ì—ì„œ UX ë©”ì‹œì§€ ì²˜ë¦¬

def center_over(parent: tk.Tk, win: tk.Toplevel) -> None:  # ë¶€ëª¨ ê¸°ì¤€ ì¤‘ì•™ ë°°ì¹˜ í•¨ìˆ˜ ì‹œê·¸ë‹ˆì²˜
    """ë¶€ëª¨ì°½ ê¸°ì¤€ìœ¼ë¡œ ìì‹ì°½ì„ í™”ë©´ ì¤‘ì•™ì— ë°°ì¹˜(í™”ë©´ ë°–ìœ¼ë¡œ ë‚˜ê°€ì§€ ì•Šê²Œ ë³´ì • í¬í•¨)."""  # ëª©ì /ë³´ì • ì„¤ëª…
    parent.update_idletasks()  # ë¶€ëª¨ ë ˆì´ì•„ì›ƒ/ìœ„ì¹˜ ì •ë³´ ìµœì‹ í™”
    win.update_idletasks()     # ìì‹ ë ˆì´ì•„ì›ƒ/í¬ê¸° ì •ë³´ ìµœì‹ í™”
    px, py = parent.winfo_rootx(), parent.winfo_rooty()     # ë¶€ëª¨ ì¢Œìƒë‹¨ì˜ í™”ë©´ ì ˆëŒ€ì¢Œí‘œ
    pw, ph = parent.winfo_width(), parent.winfo_height()    # ë¶€ëª¨ í­/ë†’ì´
    ww, wh = win.winfo_width(), win.winfo_height()          # ìì‹ í­/ë†’ì´
    # New min/maxë¡œ í™”ë©´ ê²½ê³„ë¥¼ ë„˜ì§€ ì•Šë„ë¡ ë³´ì •(ì‘ì€ í•´ìƒë„/ë©€í‹°ëª¨ë‹ˆí„°ì—ì„œë„ ì•ˆì „)
    x = max(0, min(px + (pw - ww) // 2, win.winfo_screenwidth() - ww))  # ê³„ì‚°ëœ X ì¢Œí‘œ í´ë¨í”„
    y = max(0, min(py + (ph - wh) // 2, win.winfo_screenheight() - wh))  # ê³„ì‚°ëœ Y ì¢Œí‘œ í´ë¨í”„
    win.geometry(f"+{x}+{y}")  # í¬ê¸°ëŠ” ìœ ì§€í•˜ê³  ìœ„ì¹˜ë§Œ ì´ë™

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ë°ì´í„° ëª¨ë¸                                                 # ë„ë©”ì¸ ëª¨ë¸ ì •ì˜
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
@dataclass  # dataclassë¡œ ê°„ë‹¨í•œ ë°ì´í„° ì»¨í…Œì´ë„ˆ ì •ì˜
class Todo:  # Todo ë°ì´í„° í´ë˜ìŠ¤ ì„ ì–¸
    """í•  ì¼ 1ê±´ì„ í‘œí˜„í•˜ëŠ” ë°ì´í„° ëª¨ë¸."""  # ëª¨ë¸ ëª©ì /í•„ë“œ ì˜ë¯¸ ì„¤ëª…
    title: str  # ì œëª©
    start: str  # ì‹œì‘ì¼(YYYY-MM-DD)
    end: str    # ì¢…ë£Œì¼(YYYY-MM-DD)
    desc: str = ""   # ìƒì„¸ ì„¤ëª…(ì˜µì…˜)
    status: int = 0  # ìƒíƒœ ì½”ë“œ(0=ë¯¸ì™„,1=ì§„í–‰,2=ì™„ë£Œ) â€” UI/DB ê³µìš© ì½”ë“œ

    def cycle(self) -> None:  # ìƒíƒœ ìˆœí™˜ ë©”ì„œë“œ ì‹œê·¸ë‹ˆì²˜
        """ìƒíƒœë¥¼ ë‹¤ìŒ ë‹¨ê³„ë¡œ ìˆœí™˜(0â†’1â†’2â†’0)."""  # ìˆœí™˜ ê·œì¹™ ì„¤ëª…
        self.status = (self.status + 1) % 3  # í‚¤ë³´ë“œ ìŠ¤í˜ì´ìŠ¤/ë²„íŠ¼ìœ¼ë¡œ ë¹ ë¥¸ ìƒíƒœ ì „í™˜ ì§€ì›
        # New ë¦¬ìŠ¤íŠ¸ì—ì„œ 'ìŠ¤í˜ì´ìŠ¤'ë¡œ í† ê¸€í•  ë•Œ ì´ ë©”ì„œë“œë§Œ í˜¸ì¶œí•˜ë©´ ë˜ì–´ UI-ë¡œì§ ê²°í•©ì´ ëŠìŠ¨í•´ì§„ë‹¤.

    def display(self, today: date | None = None) -> str:  # ë¦¬ìŠ¤íŠ¸ í‘œì‹œ ë¬¸ìì—´ ìƒì„± ì‹œê·¸ë‹ˆì²˜
        """ë¦¬ìŠ¤íŠ¸ë°•ìŠ¤ì— í‘œì‹œí•  1ì¤„ ìš”ì•½ ë¬¸ìì—´ì„ ìƒì„±(D-DAY íƒœê·¸ í¬í•¨)."""  # ë°˜í™˜ í¬ë§· ì„¤ëª…
        icon = STATUS_ICON.get(self.status, "â˜")  # ìƒíƒœì— ë§ëŠ” ì‹œê° ì•„ì´ì½˜
        try:
            d_end = datetime.strptime(self.end, DATE_FMT).date()  # ì¢…ë£Œì¼ íŒŒì‹±
        except Exception:
            # New ë‚ ì§œ íŒŒì‹± ì‹¤íŒ¨ ì¼€ì´ìŠ¤(ìœ íš¨ì„± ê²€ì‚¬ê°€ ì™„ë²½í•˜ì§€ ì•Šì„ ë•Œë¥¼ ëŒ€ë¹„) â†’ ìµœì†Œì •ë³´ë§Œ í‘œì‹œ
            return f"{icon} {self.start} ~ {self.end} | {self.title}"  # ì•ˆì „í•œ í´ë°± ë¬¸ìì—´

        today = today or date.today()  # today ë¯¸ì§€ì • ì‹œ ì‹œìŠ¤í…œ ì˜¤ëŠ˜ ë‚ ì§œ
        delta = (d_end - today).days   # ì¢…ë£Œì¼ê¹Œì§€ ë‚¨ì€ ì¼ìˆ˜(D-í‘œê¸° ê¸°ì¤€)
        if delta < 0:  # ë§ˆê° ì´ˆê³¼ ì—¬ë¶€ íŒë‹¨
            tag = "â›” ì§€ë‚¨"            # ë§ˆê° ì´ˆê³¼
        elif delta == 0:  # ë‹¹ì¼ ë§ˆê° ì—¬ë¶€
            tag = "âš ï¸ D-DAY"          # ë§ˆê° ë‹¹ì¼
        elif delta <= 3:  # 3ì¼ ì´ë‚´ ì„ë°• ì—¬ë¶€
            tag = f"â° D-{delta}"      # 3ì¼ ì´ë‚´ ì„ë°•
        else:  # ì¼ë°˜ ì¼€ì´ìŠ¤
            tag = f"D-{delta}"         # ì¼ë°˜ D-N í‘œê¸°
        return f"{icon} [{tag}] {self.start} ~ {self.end} | {self.title}"  # ìµœì¢… 1ì¤„ í‘œì‹œ ë¬¸ìì—´
        # New íƒœê·¸ë¥¼ í†µí•´ ë¦¬ìŠ¤íŠ¸ë§Œ ë³´ê³ ë„ ê¸´ê¸‰ë„/ìš°ì„ ìˆœìœ„ë¥¼ ì§ê´€ì ìœ¼ë¡œ íŒŒì•… ê°€ëŠ¥.

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# DB ì—°ë™                                                     # ì˜ì†í™” ë ˆì´ì–´
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
def _db() -> sql.Connection:  # DB ì—°ê²° í•¨ìˆ˜ ì‹œê·¸ë‹ˆì²˜
    """SQLite ì—°ê²°ì„ ì—´ì–´ ë°˜í™˜(ì»¨í…ìŠ¤íŠ¸ ë§¤ë‹ˆì €ì™€ í•¨ê»˜ ì‚¬ìš©)."""  # ì—°ê²° ìˆ˜ëª…/ì‚¬ìš©ë²• ì„¤ëª…
    return sql.connect(DB_PATH)  # New í˜¸ì¶œ ì‹œë§ˆë‹¤ ì§§ê²Œ ì—´ì—ˆë‹¤ê°€ with ë¸”ë¡ ì¢…ë£Œ ì‹œ ìë™ ë‹«í˜ â†’ í•¸ë“¤ ëˆ„ìˆ˜ ë°©ì§€

def init_db() -> None:  # DB ì´ˆê¸°í™” í•¨ìˆ˜ ì‹œê·¸ë‹ˆì²˜
    """ì•± ìµœì´ˆ ì‹¤í–‰ ì‹œ todos í…Œì´ë¸” ìƒì„±(ì¡´ì¬í•˜ë©´ ë¬´ì‹œ)."""  # í…Œì´ë¸” ìŠ¤í‚¤ë§ˆ ê°œìš”
    with _db() as con:  # ì—°ê²° ì»¨í…ìŠ¤íŠ¸(ì˜¤ë¥˜ ì‹œ ìë™ ë¡¤ë°±, ì •ìƒ ì‹œ ì»¤ë°‹)
        # New status ì»¬ëŸ¼ì— CHECK ì œì•½ì„ ë‘¬ì„œ ìœ íš¨í•˜ì§€ ì•Šì€ ìƒíƒœ ê°’(0/1/2 ì™¸)ì„ DB ì°¨ì›ì—ì„œ ì°¨ë‹¨
        con.execute("""
            CREATE TABLE IF NOT EXISTS todos(
                id     INTEGER PRIMARY KEY AUTOINCREMENT,  -- ë‚´ë¶€ PK(í‘œì‹œìš© ì•„ë‹˜)
                title  TEXT NOT NULL,                      -- ì œëª©
                start  TEXT NOT NULL,                      -- ì‹œì‘ì¼(YYYY-MM-DD)
                end    TEXT NOT NULL,                      -- ì¢…ë£Œì¼(YYYY-MM-DD)
                memo   TEXT DEFAULT '',                    -- ìƒì„¸ì„¤ëª…(ì˜ˆì•½ì–´ í”¼í•˜ë ¤ê³  'memo' ì‚¬ìš©)
                status INTEGER NOT NULL CHECK(status IN (0,1,2)) -- ìƒíƒœì½”ë“œ(ë¬´ê²°ì„± ë³´ì¥)
            )
        """)  # ìŠ¤í‚¤ë§ˆ ìƒì„± ì¿¼ë¦¬ ì‹¤í–‰

def load_all() -> list[Todo]:  # ì „ì²´ ë¡œë“œ í•¨ìˆ˜ ì‹œê·¸ë‹ˆì²˜
    """DBì˜ ëª¨ë“  í•­ëª©ì„ ì½ì–´ ë©”ëª¨ë¦¬(list[Todo])ë¡œ ë°˜í™˜."""  # ì •ë ¬/ëª¨ë¸ ë³€í™˜ ì„¤ëª…
    init_db()  # í…Œì´ë¸” ì¡´ì¬ ë³´ì¥
    with _db() as con:  # ì—°ê²° ì»¨í…ìŠ¤íŠ¸
        rows = con.execute(
            "SELECT title, start, end, memo, status FROM todos ORDER BY id"  # id ìˆœìœ¼ë¡œ ì•ˆì • ì •ë ¬
        ).fetchall()  # New ORDER BY idë¡œ ì‚¬ìš©ì ì…ë ¥ ìˆœì„œë¥¼ ê·¸ëŒ€ë¡œ ìœ ì§€ â†’ UX ì¼ê´€ì„±
    return [Todo(title, start, end, memo, status) for (title, start, end, memo, status) in rows]  # í–‰â†’ëª¨ë¸ ë³€í™˜
    # New ì–‡ì€ ë³€í™˜ ê³„ì¸µ: SQL í–‰ â†’ ë„ë©”ì¸ ëª¨ë¸(Todo). ë·°/ë¡œì§ì€ ëª¨ë¸ë§Œ ì‹ ê²½ ì“°ë©´ ë¨.

def save_all(items: list[Todo]) -> None:  # ì „ëŸ‰ ì €ì¥ í•¨ìˆ˜ ì‹œê·¸ë‹ˆì²˜
    """í˜„ì¬ ë©”ëª¨ë¦¬ ë¦¬ìŠ¤íŠ¸ ìƒíƒœë¥¼ DBì— ì „ëŸ‰ ë°˜ì˜(ë®ì–´ì“°ê¸° ë°©ì‹)."""  # ë‹¨ìˆœ/ì•ˆì „ ì „ëµ ì„¤ëª…
    with _db() as con:  # íŠ¸ëœì­ì…˜ ì»¨í…ìŠ¤íŠ¸
        con.execute("DELETE FROM todos")  # New ê°„ë‹¨/ì•ˆì „: ìˆœì„œ/ìƒíƒœë¥¼ ìˆëŠ” ê·¸ëŒ€ë¡œ ì¬ê¸°ë¡(ì†Œê·œëª¨ ë°ì´í„° ì „ì œ)
        con.executemany(
            "INSERT INTO todos(title, start, end, memo, status) VALUES(?,?,?,?,?)",  # ì¼ê´„ ì‚½ì… SQL
            [(t.title, t.start, t.end, t.desc, t.status) for t in items],  # íŒŒë¼ë¯¸í„° ì‹œí€€ìŠ¤
        )  # executemanyë¡œ ì„±ëŠ¥/ê°€ë…ì„±ì„ ë™ì‹œì— í™•ë³´

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# í•  ì¼ ì¶”ê°€/í¸ì§‘ íŒì—…(ëª¨ë‹¬)                                  # ì…ë ¥/í¸ì§‘ UX
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
class TodoDialog(tk.Toplevel):  # Toplevel ê¸°ë°˜ ëª¨ë‹¬ ì„ ì–¸
    """í•  ì¼ ì¶”ê°€/í¸ì§‘ì„ ìœ„í•œ ëª¨ë‹¬ ëŒ€í™”ìƒì."""  # ì—­í• /ë²”ìœ„ ì„¤ëª…

    def __init__(self, parent: tk.Tk, title: str, prefill: str = "", item: Todo | None = None):  # ìƒì„±ì ì‹œê·¸ë‹ˆì²˜
        """ë¶€ëª¨ì°½, íƒ€ì´í‹€, ì œëª© ê¸°ë³¸ê°’(prefill), í¸ì§‘ ëŒ€ìƒ(item)ì„ ë°›ì•„ íŒì—…ì„ êµ¬ì„±."""  # íŒŒë¼ë¯¸í„° ì„¤ëª…
        super().__init__(parent)  # ë¶€ëª¨ ë£¨íŠ¸ì— ë¶€ì°©ëœ Toplevel ìƒì„±
        self.result: Todo | None = None              # ì €ì¥ ì„±ê³µ ì‹œ ì±„ì›Œì§ˆ ê²°ê³¼(Todo) â€” í˜¸ì¶œìì—ì„œ íšŒìˆ˜
        self._orig_status = item.status if item else 0  # í¸ì§‘ì´ë©´ ê¸°ì¡´ ìƒíƒœë¥¼ ìœ ì§€, ì‹ ê·œë©´ 0ìœ¼ë¡œ ì‹œì‘
        # New í¸ì§‘ì—ì„œ ìƒíƒœë¥¼ ì´ˆê¸°í™”í•˜ì§€ ì•ŠëŠ” ì´ìœ : ì‚¬ìš©ìê°€ ì´ë¯¸ ì§„í–‰ì¤‘/ì™„ë£Œ ìƒíƒœë¥¼ ë¶€ì—¬í–ˆì„ ìˆ˜ ìˆê¸° ë•Œë¬¸(ì˜ë„ ì¡´ì¤‘).

        self.title(title)       # ì°½ íƒ€ì´í‹€
        self.transient(parent)  # ë¶€ëª¨ì°½ ìœ„ì— í•¨ê»˜ ë–  ìˆë„ë¡ í‘œì‹œ
        self.resizable(False, False)  # í¬ê¸° ê³ ì •(ë ˆì´ì•„ì›ƒ ë¬´ë„ˆì§ ë°©ì§€)
        self.grab_set()         # ëª¨ë‹¬(ë‹«ì„ ë•Œê¹Œì§€ ë‹¤ë¥¸ ì°½ í¬ì»¤ìŠ¤ ì°¨ë‹¨) â€” ì‹¤ìˆ˜ ë°©ì§€

        pad = PAD6  # ê³µìš© ì—¬ë°± í”„ë¦¬ì…‹
        today_str = date.today().isoformat()  # ì˜¤ëŠ˜ ë‚ ì§œ ë¬¸ìì—´

        # ì œëª© í•„ë“œ
        ttk.Label(self, text="ì œëª©").grid(row=0, column=0, sticky="w", **pad)  # ì œëª© ë¼ë²¨ ë°°ì¹˜
        self.ent_title = ttk.Entry(self, width=38)  # ì œëª© ì…ë ¥ ë°•ìŠ¤ ìƒì„±
        self.ent_title.grid(row=0, column=1, sticky="w", **pad)  # ì œëª© ì…ë ¥ ë°•ìŠ¤ ë°°ì¹˜
        self.ent_title.insert(0, prefill or (item.title if item else ""))  # New ë¹ ë¥¸ì…ë ¥(prefill) ìš°ì„  ì ìš©

        # ì‹œì‘ì¼
        ttk.Label(self, text="ì‹œì‘ì¼ (YYYY-MM-DD)").grid(row=1, column=0, sticky="w", **pad)  # ì‹œì‘ì¼ ë¼ë²¨
        self.ent_start = ttk.Entry(self, width=20)  # ì‹œì‘ì¼ ì…ë ¥ ë°•ìŠ¤
        self.ent_start.grid(row=1, column=1, sticky="w", **pad)  # ì‹œì‘ì¼ ì…ë ¥ ë°°ì¹˜
        self.ent_start.insert(0, item.start if item else today_str)  # ê¸°ë³¸ê°’: ì˜¤ëŠ˜

        # ì¢…ë£Œì¼
        ttk.Label(self, text="ì¢…ë£Œì¼ (YYYY-MM-DD)").grid(row=2, column=0, sticky="w", **pad)  # ì¢…ë£Œì¼ ë¼ë²¨
        self.ent_end = ttk.Entry(self, width=20)  # ì¢…ë£Œì¼ ì…ë ¥ ë°•ìŠ¤
        self.ent_end.grid(row=2, column=1, sticky="w", **pad)  # ì¢…ë£Œì¼ ì…ë ¥ ë°°ì¹˜
        self.ent_end.insert(0, item.end if item else today_str)  # ê¸°ë³¸ê°’: ì˜¤ëŠ˜

        # ìƒì„¸ ì„¤ëª…(ë©€í‹°ë¼ì¸)
        ttk.Label(self, text="ìƒì„¸ì„¤ëª…").grid(row=3, column=0, sticky="nw", **pad)  # ìƒì„¸ì„¤ëª… ë¼ë²¨
        self.txt_desc = tk.Text(self, width=40, height=6)  # ë©€í‹°ë¼ì¸ í…ìŠ¤íŠ¸ ë°•ìŠ¤
        self.txt_desc.grid(row=3, column=1, **pad)  # ìƒì„¸ì„¤ëª… ë°•ìŠ¤ ë°°ì¹˜
        if item:  # í¸ì§‘ ëª¨ë“œ ì—¬ë¶€
            self.txt_desc.insert("1.0", item.desc)  # í¸ì§‘ ì‹œ ê¸°ì¡´ ì„¤ëª… ì±„ì›€

        # ì €ì¥/ì·¨ì†Œ ë²„íŠ¼ í–‰
        btns = ttk.Frame(self)  # ë²„íŠ¼ ì»¨í…Œì´ë„ˆ í”„ë ˆì„
        btns.grid(row=4, column=0, columnspan=2, sticky="e", padx=10, pady=10)  # ì˜¤ë¥¸ìª½ ì •ë ¬ ë°°ì¹˜
        ttk.Button(btns, text="ì·¨ì†Œ", command=self.destroy).pack(side="right", padx=6)  # ì·¨ì†Œ ë²„íŠ¼(ì°½ ë‹«ê¸°)
        ttk.Button(btns, text="ì €ì¥", command=self._on_save).pack(side="right")  # ì €ì¥ ë²„íŠ¼(ê²€ì¦ í›„ result ì„¸íŒ…)

        # íŒì—… ë°°ì¹˜/í¬ì»¤ìŠ¤
        self.update_idletasks()     # ë‚´ë¶€ ìœ„ì ¯ í¬ê¸° ê³„ì‚°ì„ ë¨¼ì € ë°˜ì˜
        center_over(parent, self)   # ë¶€ëª¨ ê¸°ì¤€ ì¤‘ì•™ ë°°ì¹˜
        self.ent_title.focus_set()  # ì²« ì…ë ¥ í¬ì»¤ìŠ¤ëŠ” ì œëª©

    def _on_save(self) -> None:  # ì €ì¥ ì½œë°± ì‹œê·¸ë‹ˆì²˜
        """ì…ë ¥ ê²€ì¦ í›„ self.resultì— Todoë¥¼ ì„¸íŒ…í•˜ê³  íŒì—…ì„ ë‹«ëŠ”ë‹¤."""  # ì²˜ë¦¬ ìˆœì„œ ì„¤ëª…
        title = self.ent_title.get().strip()  # ì œëª© ì…ë ¥ ê°’ ì¶”ì¶œ
        start = self.ent_start.get().strip()  # ì‹œì‘ì¼ ì…ë ¥ ê°’ ì¶”ì¶œ
        end   = self.ent_end.get().strip()    # ì¢…ë£Œì¼ ì…ë ¥ ê°’ ì¶”ì¶œ
        desc  = self.txt_desc.get("1.0", "end").strip()  # ìƒì„¸ì„¤ëª… ì „ì²´ í…ìŠ¤íŠ¸ ì¶”ì¶œ

        # 1) ì œëª© í•„ìˆ˜
        if not title:  # ê³µë°±/ë¯¸ì…ë ¥ ê²€ì¦
            messagebox.showwarning("í™•ì¸", "ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”.", parent=self)  # ì‚¬ìš©ì ê²½ê³ 
            self.ent_title.focus_set()  # í¬ì»¤ìŠ¤ ë³µêµ¬
            return  # ì €ì¥ ì¤‘ë‹¨

        # 2) ë‚ ì§œ í˜•ì‹ ê²€ì¦(í¬ë§· ìƒìˆ˜ ì‚¬ìš©)
        try:
            d1 = parse_date(start)  # ì‹œì‘ì¼ íŒŒì‹± ì‹œë„
        except Exception:
            messagebox.showerror("ë‚ ì§œ ì˜¤ë¥˜", "ì‹œì‘ì¼ í˜•ì‹ì´ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤.\nì˜ˆ: 2025-09-16", parent=self)  # ì˜¤ë¥˜ ì•ˆë‚´
            self.ent_start.focus_set()  # í¬ì»¤ìŠ¤ ì´ë™
            return  # ì €ì¥ ì¤‘ë‹¨

        try:
            d2 = parse_date(end)  # ì¢…ë£Œì¼ íŒŒì‹± ì‹œë„
        except Exception:
            messagebox.showerror("ë‚ ì§œ ì˜¤ë¥˜", "ì¢…ë£Œì¼ í˜•ì‹ì´ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤.\nì˜ˆ: 2025-09-18", parent=self)  # ì˜¤ë¥˜ ì•ˆë‚´
            self.ent_end.focus_set()  # í¬ì»¤ìŠ¤ ì´ë™
            return  # ì €ì¥ ì¤‘ë‹¨

        # 3) ë…¼ë¦¬ ê²€ì¦(ì¢…ë£Œì¼ < ì‹œì‘ì¼ ê¸ˆì§€)
        if d2 < d1:  # ë‚ ì§œ ë…¼ë¦¬ ê²€ì¦
            messagebox.showerror("ë‚ ì§œ ì˜¤ë¥˜", "ì¢…ë£Œì¼ì€ ì‹œì‘ì¼ë³´ë‹¤ ë¹ ë¥¼ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.", parent=self)  # ì˜¤ë¥˜ ì•ˆë‚´
            self.ent_end.focus_set()  # í¬ì»¤ìŠ¤ ì´ë™
            return  # ì €ì¥ ì¤‘ë‹¨

        # 4) ê²°ê³¼ ì„¸íŒ… í›„ ë‹«ê¸°
        self.result = Todo(title=title, start=start, end=end, desc=desc, status=self._orig_status)  # ê²°ê³¼ êµ¬ì„±
        self.destroy()  # íŒì—… ë‹«ê¸°
        # New íŒì—… ì™¸ë¶€ì—ì„œëŠ” self.result ì¡´ì¬ ì—¬ë¶€ë§Œ í™•ì¸í•´ ì¶”ê°€/êµì²´ ë¡œì§ì„ ê°„ë‹¨íˆ ì²˜ë¦¬í•œë‹¤.

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ë©”ì¸ ì•±(ë…¸íŠ¸ë¶ íƒ­: í•  ì¼ / íƒ€ì´ë¨¸ / ë¦¬í¬íŠ¸)                 # ìµœìƒìœ„ ìœˆë„ìš°/íƒ­ êµ¬ì¡°
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
class TodoApp(tk.Tk):  # Tk ë£¨íŠ¸ ìœˆë„ìš° ìƒì†
    """ìµœìƒìœ„ ìœˆë„ìš°: íƒ­ ì»¨í…Œì´ë„ˆ + ê° íƒ­ ë¡œì§ì„ í¬í•¨."""  # ì—­í•  ê°œìš”

    def __init__(self) -> None:  # ìƒì„±ì ì‹œê·¸ë‹ˆì²˜
        """ì°½ ìƒì„±/í¬ê¸°/íƒ­ êµ¬ì„±/DB ë¡œë“œ/ì´ˆê¸° ë Œë”ë§ê¹Œì§€ í•œ ë²ˆì— ìˆ˜í–‰."""  # ì´ˆê¸°í™” í”Œë¡œ ì„¤ëª…
        super().__init__()  # Tk ë£¨íŠ¸ ì´ˆê¸°í™”
        self.title("ê°“ìƒì‚´ê¸°")  # ì°½ íƒ€ì´í‹€ ì„¸íŒ…
        sw, sh = self.winfo_screenwidth(), self.winfo_screenheight()  # ìŠ¤í¬ë¦° í¬ê¸° ì¡°íšŒ
        x, y = (sw - 580) // 2, (sh - 380) // 2  # ì¤‘ì•™ ì¢Œí‘œ ê³„ì‚°
        self.geometry(f"580x380+{x}+{y}")  # New ë°œí‘œ/ì‹œì—°ì— ì í•©í•œ ì†Œí˜• ê³ ì • í¬ê¸°(ê°€ë…ì„± ìš°ì„ )

        # ì•ˆì „ ì¢…ë£Œ í•¸ë“¤ëŸ¬: ì˜ˆì•½ëœ after/ê¹œë°•ì„ ë“±ì„ ëª¨ë‘ ì •ë¦¬
        self.protocol("WM_DELETE_WINDOW", self._on_close)  # ë‹«ê¸° ì´ë²¤íŠ¸ ë°”ì¸ë”©

        # ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒíƒœ(ë©”ëª¨ë¦¬)
        self.todos: list[Todo] = []  # í˜„ì¬ ì„¸ì…˜ì˜ í•  ì¼ ë¦¬ìŠ¤íŠ¸(í™”ë©´/DB ì‹±í¬ëŠ” save_all/load_allë¡œ ìœ ì§€)

        # â”€â”€ íƒ€ì´ë¨¸ ìƒíƒœ(ëª¨ë…¸í† ë‹‰ ê¸°ë°˜) â”€â”€
        self._timer_after_id: str | None = None  # íƒ€ì´ë¨¸ í‹± ë£¨í”„ ì˜ˆì•½ ID(after_cancelìš©)
        self._blink_after_id: str | None = None  # íƒ€ì„ì—… ê¹œë°•ì„ ë£¨í”„ ID
        self.timer_running: bool = False  # íƒ€ì´ë¨¸ ë™ì‘ ì—¬ë¶€
        self.timer_total_sec: int = 0     # ì´ íƒ€ì´ë¨¸ ì‹œê°„(ì´ˆ)
        self.timer_warn_sec: int = 30     # ê²½ê³  ì‹œì‘ ì„ê³„(ì´ˆ)
        self.timer_end_mono: float = 0.0  # ë‹¨ì¡° ì‹œê³„ ê¸°ì¤€ ì¢…ë£Œ ëª©í‘œ ì‹œê°
        self.timer_remain_sec: int = 0    # ë‚¨ì€ ì‹œê°„(ì´ˆ)
        self._blink_on: bool = False      # ê¹œë°•ì„ í† ê¸€ ìƒíƒœ
        # New time.monotonic() ì‚¬ìš©ìœ¼ë¡œ OS ì‹œê°„ ë³€ê²½/ë™ê¸°í™”ì— ë”°ë¥¸ íŠ€ëŠ” í˜„ìƒ ë°©ì§€.

        # â”€â”€ ë¦¬í¬íŠ¸ ë£¨í”„/ë§ˆì¼ìŠ¤í†¤ ìƒíƒœ â”€â”€
        self._report_after_id: str | None = None  # ë¦¬í¬íŠ¸ ìë™ ê°±ì‹  ë£¨í”„ ID(after_cancelìš©)
        self._last_rate: float = 0.0              # ì´ì „ ì™„ë£Œìœ¨(ë§ˆì¼ìŠ¤í†¤ ëŒíŒŒ ê°ì§€)
        self._report_booted: bool = False         # New ì²« ê°±ì‹  ì—¬ë¶€(ì•± ì‹œì‘ ì§í›„ ì»¨í˜í‹° ì˜¤ë°œ ë°©ì§€)

        # íƒ­ ì»¨í…Œì´ë„ˆ
        nb = ttk.Notebook(self)  # ë…¸íŠ¸ë¶ ìœ„ì ¯ ìƒì„±
        nb.pack(expand=True, fill="both", padx=10, pady=10)  # ì°½ ë‚´ë¶€ì— ë°°ì¹˜

        # íƒ­ ìƒì„±(ì„±ì  íƒ­ì€ ì œê±°)
        self.tab_todo   = ttk.Frame(nb)  # í•  ì¼ íƒ­ í”„ë ˆì„
        self.tab_timer  = ttk.Frame(nb)  # íƒ€ì´ë¨¸ íƒ­ í”„ë ˆì„
        self.tab_report = ttk.Frame(nb)  # ë¦¬í¬íŠ¸ íƒ­ í”„ë ˆì„
        nb.add(self.tab_todo, text="í•  ì¼")  # íƒ­ ì¶”ê°€(í•  ì¼)
        nb.add(self.tab_timer, text="íƒ€ì´ë¨¸")  # íƒ­ ì¶”ê°€(íƒ€ì´ë¨¸)
        nb.add(self.tab_report, text="ë¦¬í¬íŠ¸")  # íƒ­ ì¶”ê°€(ë¦¬í¬íŠ¸)
        # New ì‚¬ìš©ìê°€ ë°”ë¡œ ë¦¬í¬íŠ¸ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë„ë¡ íƒ­ ìˆœì„œë¥¼ ë‹¨ìˆœí™”(3ê°œ).

        # ê° íƒ­ UI êµ¬ì„±
        self._build_todo_tab()  # í•  ì¼ íƒ­ êµ¬ì„±
        self._build_timer_tab()  # íƒ€ì´ë¨¸ íƒ­ êµ¬ì„±
        self._build_report_tab()  # ë¦¬í¬íŠ¸ íƒ­ êµ¬ì„±

        # DB â†’ ë©”ëª¨ë¦¬ â†’ UI ì´ˆê¸° ë Œë”
        init_db()  # í…Œì´ë¸” ë³´ì¥
        self.todos = load_all()  # DBë¡œë¶€í„° ë¡œë“œ
        self.refresh_list()  # New ë‚´ë¶€ì—ì„œ refresh_report()ë„ í˜¸ì¶œí•˜ì—¬ ì²« í™”ë©´ë¶€í„° ì¼ê´€ëœ ìƒíƒœ í‘œì‹œ

    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    # [í•  ì¼] íƒ­ UI                                            # ToDo íƒ­ êµ¬ì„±
    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    def _build_todo_tab(self) -> None:  # í•  ì¼ íƒ­ ë¹Œë“œ í•¨ìˆ˜
        """í•  ì¼ íƒ­ì˜ ì…ë ¥/ë²„íŠ¼/ë¦¬ìŠ¤íŠ¸ UIë¥¼ êµ¬ì„±."""  # êµ¬ì„± ìš”ì†Œ ì„¤ëª…
        top = ttk.Frame(self.tab_todo)  # ìƒë‹¨ ì…ë ¥/ë²„íŠ¼ ì»¨í…Œì´ë„ˆ
        top.pack(fill="x", padx=10, pady=10)  # ê°€ë¡œ ì±„ì›€ ë°°ì¹˜

        # ë¹ ë¥¸ ì œëª© ì…ë ¥ + Enterë¡œ ì¦‰ì‹œ ì¶”ê°€
        self.quick_entry = ttk.Entry(top)  # ì œëª© í•œ ì¤„ ì…ë ¥ ìœ„ì ¯
        self.quick_entry.pack(side="left", fill="x", expand=True)  # ì¢Œì¸¡ë¶€í„° í™•ì¥ ë°°ì¹˜
        self.quick_entry.focus()  # ì‹œì‘ ì‹œ í¬ì»¤ìŠ¤ ë¶€ì—¬
        self.quick_entry.bind("<Return>", lambda e: self.add_todo())  # New í…ìŠ¤íŠ¸ ì…ë ¥ â†’ Enter í•œ ë²ˆìœ¼ë¡œ ë“±ë¡

        # ê¸°ë³¸ ë²„íŠ¼ë“¤(CRUD + ìƒíƒœì „í™˜)
        ttk.Button(top, text="ì¶”ê°€",   command=self.add_todo).pack(side="left", padx=6)  # ì¶”ê°€ ë²„íŠ¼
        ttk.Button(top, text="í¸ì§‘",   command=self.edit_selected).pack(side="left", padx=6)  # í¸ì§‘ ë²„íŠ¼
        ttk.Button(top, text="ì‚­ì œ",   command=self.delete_selected).pack(side="left", padx=6)  # ì‚­ì œ ë²„íŠ¼
        ttk.Button(top, text="ìƒíƒœì „í™˜ (â˜â†’â³â†’âœ”)", command=self.cycle_status_selected).pack(side="left", padx=6)  # ìƒíƒœ ìˆœí™˜ ë²„íŠ¼

        # ë¦¬ìŠ¤íŠ¸ + ìŠ¤í¬ë¡¤
        mid = ttk.Frame(self.tab_todo)  # ë¦¬ìŠ¤íŠ¸/ìŠ¤í¬ë¡¤ ì»¨í…Œì´ë„ˆ
        mid.pack(fill="both", expand=True, padx=10, pady=5)  # ë‚¨ëŠ” ê³µê°„ ì±„ìš°ê¸°

        self.listbox = tk.Listbox(mid, height=10, selectmode="extended")  # New ë‹¤ì¤‘ ì„ íƒìœ¼ë¡œ ì¼ê´„ ì‚­ì œ/ìƒíƒœì „í™˜ ê°€ëŠ¥
        self.listbox.pack(side="left", fill="both", expand=True)  # ë¦¬ìŠ¤íŠ¸ ë°•ìŠ¤ ë°°ì¹˜

        scroll = ttk.Scrollbar(mid, orient="vertical", command=self.listbox.yview)  # ì„¸ë¡œ ìŠ¤í¬ë¡¤ë°”
        scroll.pack(side="left", fill="y")  # ìŠ¤í¬ë¡¤ë°” ë°°ì¹˜
        self.listbox.config(yscrollcommand=scroll.set)  # ë¦¬ìŠ¤íŠ¸ì™€ ìŠ¤í¬ë¡¤ë°” ì—°ë™

        # ë‹¨ì¶•í‚¤(ìƒì‚°ì„±)
        self.listbox.bind("<Delete>", lambda e: self.delete_selected())  # Del: ì‚­ì œ
        self.listbox.bind("<space>",  self._on_space_toggle)             # Space: ìƒíƒœ í† ê¸€
        self.listbox.bind("<Double-Button-1>", self.show_details)        # ë”ë¸”í´ë¦­: ìƒì„¸ ë³´ê¸°

    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    # [íƒ€ì´ë¨¸] íƒ­ UI                                            # ë°œí‘œ íƒ€ì´ë¨¸ UI
    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    def _build_timer_tab(self) -> None:  # íƒ€ì´ë¨¸ íƒ­ ë¹Œë“œ í•¨ìˆ˜
        """ë°œí‘œ íƒ€ì´ë¨¸ ì…ë ¥/ì»¨íŠ¸ë¡¤/í”¼ë“œë°± UI êµ¬ì„±."""  # êµ¬ì„± ìš”ì†Œ ì„¤ëª…
        top = ttk.Frame(self.tab_timer)  # ìƒë‹¨ ì…ë ¥/ì»¨íŠ¸ë¡¤ ì»¨í…Œì´ë„ˆ
        top.pack(fill="x", **PAD8)  # ê°€ë¡œ ì±„ì›€

        # ì‹œê°„/ì„ê³„ê°’ ì…ë ¥
        ttk.Label(top, text="ë°œí‘œ ì‹œê°„(ë¶„)").pack(side="left")  # ë¶„ ì…ë ¥ ë¼ë²¨
        self.ent_minutes = ttk.Entry(top, width=6)  # ë¶„ ì…ë ¥ ë°•ìŠ¤
        self.ent_minutes.pack(side="left", padx=(4, 12))  # ë¼ë²¨ê³¼ ê°„ê²©
        self.ent_minutes.insert(0, "5")  # ê¸°ë³¸ 5ë¶„

        ttk.Label(top, text="ê²½ê³  ì„ê³„(ì´ˆ)").pack(side="left")  # ê²½ê³  ì„ê³„ ë¼ë²¨
        self.ent_warn = ttk.Entry(top, width=6)  # ê²½ê³  ì„ê³„ ì…ë ¥ ë°•ìŠ¤
        self.ent_warn.pack(side="left", padx=(4, 12))  # ê°„ê²©
        self.ent_warn.insert(0, "30")  # ê¸°ë³¸ 30ì´ˆ

        # ì»¨íŠ¸ë¡¤ ë²„íŠ¼(ìƒíƒœ íë¦„ì— ë”°ë¼ í™œì„±/ë¹„í™œì„±í™”)
        self.btn_start = ttk.Button(top, text="ì‹œì‘",     command=self.start_timer)  # ì‹œì‘ ë²„íŠ¼
        self.btn_pause = ttk.Button(top, text="ì¼ì‹œì •ì§€", command=self.pause_resume_timer, state="disabled")  # ì¼ì‹œì •ì§€ ë²„íŠ¼
        self.btn_reset = ttk.Button(top, text="ì´ˆê¸°í™”",   command=self.reset_timer,       state="disabled")  # ì´ˆê¸°í™” ë²„íŠ¼
        self.btn_start.pack(side="left", padx=4)  # ë²„íŠ¼ ë°°ì¹˜
        self.btn_pause.pack(side="left", padx=4)  # ë²„íŠ¼ ë°°ì¹˜
        self.btn_reset.pack(side="left", padx=4)  # ë²„íŠ¼ ë°°ì¹˜

        # ì¤‘ì•™: ë‚¨ì€ ì‹œê°„ + ì§„í–‰ë¥  ë°”
        mid = ttk.Frame(self.tab_timer)  # ì¤‘ì•™ í‘œì‹œ ì˜ì—­
        mid.pack(expand=True, fill="both", **PAD8)  # ë‚¨ëŠ” ê³µê°„ ì±„ì›€
        self.lbl_timer = tk.Label(mid, text="00:00", font=("Helvetica", 36, "bold"))  # ë‚¨ì€ ì‹œê°„ ë¼ë²¨
        self.lbl_timer.pack(pady=10)  # ì—¬ë°±
        self.pb_timer  = ttk.Progressbar(mid, orient="horizontal", mode="determinate", length=360)  # ì§„í–‰ë¥  ë°”
        self.pb_timer.pack(fill="x", padx=20, pady=10)  # ë°” ë°°ì¹˜

        # í•˜ë‹¨: ì‚¬ìš© íŒ
        bottom = ttk.Frame(self.tab_timer)  # í•˜ë‹¨ í”„ë ˆì„
        bottom.pack(fill="x", **PAD8)  # ê°€ë¡œ ì±„ì›€
        ttk.Label(
            bottom,
            text="Tip) ë‚¨ì€ ì‹œê°„ì´ ì„ê³„ê°’ ì´í•˜ë¡œ ë–¨ì–´ì§€ë©´ ì£¼í™©ìƒ‰, 0ì´ ë˜ë©´ ë¹¨ê°„ìƒ‰ìœ¼ë¡œ ê¹œë°•ì´ë©° ì¢…ë£Œë¥¼ ì•Œë¦½ë‹ˆë‹¤."
        ).pack(anchor="w")  # ì¢Œì¸¡ ì •ë ¬ ë¼ë²¨

    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    # [ë¦¬í¬íŠ¸] íƒ­ UI (í…ìŠ¤íŠ¸ KPI + ë„ë„› + ìŠ¤íƒë°” + ì£¼ê°„ íˆíŠ¸ë§µ)  # ëŒ€ì‹œë³´ë“œ êµ¬ì„±
    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    def _build_report_tab(self) -> None:  # ë¦¬í¬íŠ¸ íƒ­ ë¹Œë“œ í•¨ìˆ˜
        """ë¦¬í¬íŠ¸ íƒ­ì˜ KPI í…ìŠ¤íŠ¸/ê°„ë‹¨ ì‹œê°í™” ìœ„ì ¯ì„ êµ¬ì„±."""  # íƒ­ì˜ ëª©ì /êµ¬ì„± ì„¤ëª…
        frm = ttk.Frame(self.tab_report)  # ë£¨íŠ¸ ì»¨í…Œì´ë„ˆ í”„ë ˆì„
        frm.pack(fill="both", expand=True, padx=12, pady=12)  # í”„ë ˆì„ ë°°ì¹˜

        ttk.Label(frm, text="ğŸ“Š ì£¼ê°„ ì„±ê³¼ ë¦¬í¬íŠ¸", font=("Helvetica", 14, "bold")
                 ).pack(anchor="w", pady=(0, 8))  # ì œëª© ë¼ë²¨(í¬ê²Œ/ë³¼ë“œ)
        
        # New ìƒë‹¨ ì˜ì—­: ì¢Œì¸¡ ë„ë„›, ìš°ì¸¡ í…ìŠ¤íŠ¸ KPI ë¸”ëŸ­ìœ¼ë¡œ 2ì—´ ë ˆì´ì•„ì›ƒì„ êµ¬ì„±
        top = ttk.Frame(frm)  # ìƒë‹¨ í–‰ ì»¨í…Œì´ë„ˆ
        top.pack(fill="x")  # ê°€ë¡œ ì±„ì›€

        # ë„ë„› ê²Œì´ì§€(ì™„ë£Œìœ¨ í•µì‹¬ KPI)
        self.cnv_ring = tk.Canvas(top, width=160, height=160, highlightthickness=0)  # ë„ë„› ìº”ë²„ìŠ¤
        self.cnv_ring.pack(side="left", padx=(0, 16))  # ì¢Œì¸¡ ë°°ì¹˜, ìš°ì¸¡ ì—¬ë°± í™•ë³´

        # ì˜¤ë¥¸ìª½ í…ìŠ¤íŠ¸ KPI ë¬¶ìŒ
        right = ttk.Frame(top)  # ìš°ì¸¡ KPI ì»¨í…Œì´ë„ˆ
        right.pack(side="left", fill="both", expand=True)  # ë‚¨ëŠ” ê³µê°„ ì±„ì›€
        self.lbl_rate   = ttk.Label(right, text="ì™„ë£Œìœ¨ 0.0%", font=("Helvetica", 12, "bold"))  # ì™„ë£Œìœ¨ êµµì€ ë¼ë²¨
        self.lbl_rate.pack(anchor="w", pady=(4, 6))  # ë¼ë²¨ ë°°ì¹˜

        self.var_avg    = tk.StringVar(value="í‰ê·  ê¸°ê°„: 0.0ì¼")  # í‰ê·  ê¸°ê°„ ë°”ì¸ë”© ë³€ìˆ˜
        self.var_soon   = tk.StringVar(value="ë§ˆê° ì„ë°•: 0ê±´")    # ì„ë°• ê±´ìˆ˜ ë°”ì¸ë”© ë³€ìˆ˜
        self.var_over   = tk.StringVar(value="ì§€ë‚¨: 0ê±´")  # ì§€ë‚¨ ê±´ìˆ˜ ë°”ì¸ë”© ë³€ìˆ˜
        self.var_counts = tk.StringVar(value="ìƒíƒœ êµ¬ì„±: ë¯¸ì™„ 0 Â· ì§„í–‰ 0 Â· ì™„ë£Œ 0")  # ìƒíƒœ êµ¬ì„± ë°”ì¸ë”© ë³€ìˆ˜

        ttk.Label(right, textvariable=self.var_avg   ).pack(anchor="w")  # í‰ê·  í‘œê¸° ë¼ë²¨
        ttk.Label(right, textvariable=self.var_soon  ).pack(anchor="w")  # ì„ë°• í‘œê¸° ë¼ë²¨
        ttk.Label(right, textvariable=self.var_over  ).pack(anchor="w")  # ì§€ë‚¨ í‘œê¸° ë¼ë²¨
        ttk.Label(right, textvariable=self.var_counts).pack(anchor="w", pady=(2, 0))  # ìƒíƒœ êµ¬ì„± ë¼ë²¨
        # New ìˆ«ì + ì„¤ëª…ì„ ê°™ì´ í‘œê¸°í•´ 'ì½íˆëŠ” KPI'ë¥¼ ì§€í–¥(ê·¸ë˜í”„ í•´ì„ì‹œê°„ì„ ì¤„ì„).

        # ìƒíƒœ ë¹„ì¤‘ ìŠ¤íƒë°”
        self.cnv_stack = tk.Canvas(frm, height=22, highlightthickness=0)  # ìŠ¤íƒë°” ìº”ë²„ìŠ¤
        self.cnv_stack.pack(fill="x", pady=(10, 6))  # ê°€ë¡œ ì±„ì›€ + ìƒí•˜ ì—¬ë°±

        # ì´ë²ˆ ì£¼ ë§ˆê° íˆíŠ¸ë§µ(ì›”~ì¼)
        self.cnv_heat = tk.Canvas(frm, height=56, highlightthickness=0)  # íˆíŠ¸ë§µ ìº”ë²„ìŠ¤
        self.cnv_heat.pack(fill="x")  # ê°€ë¡œ ì±„ì›€

        ttk.Label(frm, text="â€» 5ì´ˆë§ˆë‹¤ ìë™ ê°±ì‹  Â· ë¦¬ìŠ¤íŠ¸ ë³€ê²½ ì‹œ ì¦‰ì‹œ ë°˜ì˜", foreground="#666"
                 ).pack(anchor="w", pady=(8, 0))  # ì•ˆë‚´ ë¼ë²¨(ë³´ì¡° ìƒ‰)
        # New ì‹¤ì‹œê°„ì„±(ìë™/ì¦‰ì‹œ)ì„ ëª…ì‹œí•´ â€œì‚´ì•„ìˆëŠ” ë¦¬í¬íŠ¸â€ ëŠë‚Œ ê°•í™”.

    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    # ê³µí†µ ë™ì‘: ì„ íƒ/ë¦¬ìŠ¤íŠ¸ ê°±ì‹ /ì €ì¥                           # ê³µí†µ í—¬í¼
    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    def _selected_indices(self) -> tuple[int, ...] | None:  # ì„ íƒ ì¸ë±ìŠ¤ íšë“ í•¨ìˆ˜
        """ë¦¬ìŠ¤íŠ¸ë°•ìŠ¤ì—ì„œ ì‚¬ìš©ìê°€ ì„ íƒí•œ í•­ëª© ì¸ë±ìŠ¤ íŠœí”Œì„ ë°˜í™˜(ì—†ìœ¼ë©´ ê²½ê³  í›„ None)."""  # ë°˜í™˜/ì—ëŸ¬ ê²½ê³  ì„¤ëª…
        sel = self.listbox.curselection()  # í˜„ì¬ ì„ íƒëœ ì¸ë±ìŠ¤ë“¤
        if not sel:  # ì„ íƒ ì—†ìŒ
            messagebox.showwarning("í™•ì¸", "í•­ëª©ì„ ì„ íƒí•˜ì„¸ìš”.", parent=self)  # ì‚¬ìš©ì ê²½ê³ 
            return None  # None ë°˜í™˜
        return sel  # ì„ íƒ ì¸ë±ìŠ¤ íŠœí”Œ ë°˜í™˜
        # New selectmode="extended"ì´ë¯€ë¡œ ì—¬ëŸ¬ í•­ëª©ì„ í•œ ë²ˆì— ì¡°ì‘ ê°€ëŠ¥(ì‚­ì œ/ìƒíƒœì „í™˜).

    def refresh_list(self) -> None:  # ë¦¬ìŠ¤íŠ¸ ë¦¬í”„ë ˆì‹œ í•¨ìˆ˜
        """í˜„ì¬ self.todosë¥¼ ë¦¬ìŠ¤íŠ¸ë°•ìŠ¤ì— ë°˜ì˜í•˜ê³ , ë¦¬í¬íŠ¸ë„ í•¨ê»˜ ê°±ì‹ ."""  # ì²˜ë¦¬ ë‚´ìš© ì„¤ëª…
        self.listbox.delete(0, tk.END)  # ê¸°ì¡´ ë‚´ìš© ì´ˆê¸°í™”
        if self.todos:  # í•­ëª© ì¡´ì¬ ì‹œ
            self.listbox.insert(tk.END, *[t.display() for t in self.todos])  # display()ëŠ” D-DAY íƒœê·¸ í¬í•¨ ë¬¸ìì—´
        self.refresh_report()  # New ë¦¬ìŠ¤íŠ¸ ë³€ê²½ â†’ ë¦¬í¬íŠ¸ ì¦‰ì‹œ ê°±ì‹ (í–‰ë™ê³¼ í”¼ë“œë°±ì˜ ì—°ê²°)

    def _save(self) -> None:  # ì €ì¥ í•¨ìˆ˜
        """í˜„ì¬ ë©”ëª¨ë¦¬ ë¦¬ìŠ¤íŠ¸(self.todos)ë¥¼ DBì— ì €ì¥(ë®ì–´ì“°ê¸° ë°©ì‹)."""  # ì €ì¥ ì „ëµ ì„¤ëª…
        save_all(self.todos)  # ë®ì–´ì“°ê¸° ì €ì¥ í˜¸ì¶œ
        # New ëª¨ë“  ì¡°ì‘ íë¦„ì€ 'ì €ì¥ â†’ ë¦¬ìŠ¤íŠ¸ ê°±ì‹  â†’ ë¦¬í¬íŠ¸ ê°±ì‹ 'ìœ¼ë¡œ í†µì¼í•˜ì—¬ í™”ë©´/DB ì‹±í¬ë¥¼ ë³´ì¥.

    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    # ì‚¬ìš©ì ì•¡ì…˜: ì¶”ê°€/í¸ì§‘/ì‚­ì œ/ìƒíƒœì „í™˜/ìƒì„¸ë³´ê¸°               # CRUD/í† ê¸€/ë·°
    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    def add_todo(self) -> None:  # ì¶”ê°€ í•¸ë“¤ëŸ¬
        """ìƒˆ í•  ì¼ì„ ì¶”ê°€(ë¹ ë¥¸ì…ë ¥ì¹¸ ë‚´ìš©ìœ¼ë¡œ ì œëª© prefill)."""  # UX íë¦„ ì„¤ëª…
        prefill = self.quick_entry.get().strip()  # prefill í…ìŠ¤íŠ¸ ì¶”ì¶œ
        dlg = TodoDialog(self, "í•  ì¼ ì¶”ê°€", prefill=prefill)  # ì¶”ê°€ íŒì—… ìƒì„±
        self.wait_window(dlg)       # ëª¨ë‹¬ ì™„ë£Œ ëŒ€ê¸°
        if dlg.result:              # ì €ì¥ë˜ì—ˆìœ¼ë©´
            self.todos.append(dlg.result)  # ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€
            self._save()  # DBì— ë°˜ì˜
            self.refresh_list()  # UI ê°±ì‹ 

    def edit_selected(self) -> None:  # í¸ì§‘ í•¸ë“¤ëŸ¬
        """ì„ íƒí•œ ì²« í•­ëª©ì„ í¸ì§‘ íŒì—…ìœ¼ë¡œ ì—´ê³  ì €ì¥ ì‹œ êµì²´."""  # ë™ì‘ ì„¤ëª…
        sel = self._selected_indices()  # ì„ íƒ í™•ì¸
        if not sel:  # ë¬´ì„ íƒ
            return  # ì¡°ìš©íˆ ì¢…ë£Œ
        idx = sel[0]  # ì²« ì„ íƒ ì¸ë±ìŠ¤
        dlg = TodoDialog(self, "í•  ì¼ í¸ì§‘", item=self.todos[idx])  # í¸ì§‘ ëª¨ë‹¬
        self.wait_window(dlg)  # ëŒ€ê¸°
        if dlg.result:  # ì €ì¥ë¨
            self.todos[idx] = dlg.result  # êµì²´
            self._save()  # ì €ì¥
            self.refresh_list()  # ê°±ì‹ 

    def delete_selected(self) -> None:  # ì‚­ì œ í•¸ë“¤ëŸ¬
        """ì„ íƒëœ ì—¬ëŸ¬ í•­ëª©ì„ ì‚­ì œ(ë’¤ì—ì„œë¶€í„° ì§€ì›Œ ì¸ë±ìŠ¤ ë‹¹ê¹€ ë¬¸ì œ ë°©ì§€)."""  # êµ¬í˜„ ìƒì„¸ ì„¤ëª…
        sel = self._selected_indices()  # ì„ íƒ í™•ì¸
        if not sel:  # ë¬´ì„ íƒ
            return  # ì¢…ë£Œ
        if not messagebox.askyesno("ì‚­ì œ í™•ì¸", f"ì„ íƒí•œ {len(sel)}ê°œ í•­ëª©ì„ ì •ë§ ì‚­ì œí• ê¹Œìš”?", parent=self):  # ì‚¬ìš©ì í™•ì¸
            return  # ì·¨ì†Œ
        for i in reversed(sel):  # New ë’¤ì—ì„œë¶€í„° ì§€ìš°ë©´ ì•ìª½ ì¸ë±ìŠ¤ì˜ ì•ˆì „ì„±ì´ ë³´ì¥ë¨
            del self.todos[i]  # ë¦¬ìŠ¤íŠ¸ì—ì„œ ì œê±°
        self._save()  # ì €ì¥
        self.refresh_list()  # ê°±ì‹ 

    def cycle_status_selected(self) -> None:  # ìƒíƒœ ìˆœí™˜ í•¸ë“¤ëŸ¬
        """ì„ íƒëœ ëª¨ë“  í•­ëª©ì˜ ìƒíƒœë¥¼ 0â†’1â†’2â†’0 ìˆœí™˜."""  # ë™ì‘ ì„¤ëª…
        sel = self._selected_indices()  # ì„ íƒ í™•ì¸
        if not sel:  # ë¬´ì„ íƒ
            return  # ì¢…ë£Œ
        for i in sel:  # ì„ íƒ í•­ëª© ìˆœíšŒ
            self.todos[i].cycle()  # ìƒíƒœ ìˆœí™˜ ì‹¤í–‰
        self._save()  # ì €ì¥
        self.refresh_list()  # ê°±ì‹ 

    def _on_space_toggle(self, _e) -> str:  # ìŠ¤í˜ì´ìŠ¤ í† ê¸€ ë°”ì¸ë”©
        """ìŠ¤í˜ì´ìŠ¤ë°”ë¡œ ìƒíƒœ ìˆœí™˜(ë¦¬ìŠ¤íŠ¸ë°•ìŠ¤ ê¸°ë³¸ ìŠ¤í˜ì´ìŠ¤ ë™ì‘ì€ ì°¨ë‹¨)."""  # ê¸°ë³¸ ë™ì‘ ì°¨ë‹¨ ì´ìœ  ì„¤ëª…
        self.cycle_status_selected()  # ìƒíƒœ ìˆœí™˜ í˜¸ì¶œ
        return "break"  # New Tkì˜ ê¸°ë³¸ ìŠ¤í˜ì´ìŠ¤ ë™ì‘(ì„ íƒ ì´ë™)ì„ ë§‰ì§€ ì•Šìœ¼ë©´ UXê°€ í˜¼ë€ìŠ¤ëŸ¬ì›Œì§

    def show_details(self, _e=None) -> None:  # ìƒì„¸ë³´ê¸° í•¸ë“¤ëŸ¬
        """ì„ íƒëœ ì²« í•­ëª©ì˜ ìƒì„¸ ì •ë³´(ì½ê¸° ì „ìš©) íŒì—…ì„ í‘œì‹œ."""  # í‘œì‹œ ë‚´ìš© ì„¤ëª…
        sel = self._selected_indices()  # ì„ íƒ í™•ì¸
        if not sel:  # ë¬´ì„ íƒ
            return  # ì¢…ë£Œ
        t = self.todos[sel[0]]  # ëŒ€ìƒ í•­ëª©
        icon = STATUS_ICON.get(t.status, "â˜")  # ìƒíƒœ ì•„ì´ì½˜
        msg = (  # ìƒì„¸ ë©”ì‹œì§€ ë¬¸ìì—´
            f"ì œëª©: {t.title}\n"
            f"ê¸°ê°„: {t.start} ~ {t.end}\n"
            f"ìƒíƒœ: {icon} {STATUS_TEXT.get(t.status,'')}\n\n"
            f"ìƒì„¸ì„¤ëª…:\n{t.desc or '(ì—†ìŒ)'}"
        )  # ë©”ì‹œì§€ êµ¬ì„± ì™„ë£Œ
        messagebox.showinfo("í•  ì¼ ìƒì„¸", msg, parent=self)  # ì •ë³´ íŒì—… í‘œì‹œ

    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    # íƒ€ì´ë¨¸ ë¡œì§(ëª¨ë…¸í† ë‹‰ ê¸°ë°˜, ë“œë¦¬í”„íŠ¸ ìµœì†Œí™”)                 # íƒ€ì´ë¨¸ ì—”ì§„
    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    def _format_sec(self, s: int) -> str:  # í¬ë§· í•¨ìˆ˜ ì‹œê·¸ë‹ˆì²˜
        """ì •ìˆ˜ ì´ˆë¥¼ 'MM:SS' í˜•ì‹ ë¬¸ìì—´ë¡œ ë³€í™˜(ìŒìˆ˜ ë°©ì§€/0 íŒ¨ë”© í¬í•¨)."""  # í¬ë§· ê·œì¹™ ì„¤ëª…
        s = max(0, int(s))  # ìŒìˆ˜ ë°©ì§€ ë° ì •ìˆ˜í™”
        m, ss = divmod(s, 60)  # ë¶„/ì´ˆ ë¶„ë¦¬
        return f"{m:02d}:{ss:02d}"  # 2ìë¦¬ 0íŒ¨ë”© í¬ë§·

    def _set_timer_controls_running(self, running: bool) -> None:  # ì»¨íŠ¸ë¡¤ ìƒíƒœ ì „í™˜ í•¨ìˆ˜
        """íƒ€ì´ë¨¸ ì‹¤í–‰ ì—¬ë¶€ì— ë”°ë¼ ë²„íŠ¼/ì…ë ¥ ìƒíƒœë¥¼ ì „í™˜(ì˜¤ì¡°ì‘ ë°©ì§€)."""  # UI ìƒíƒœ ë¨¸ì‹  ì„¤ëª…
        if running:  # ì‹¤í–‰ ì¤‘
            self.btn_start.config(state="disabled")  # ì‹œì‘ ë¹„í™œì„±í™”
            self.btn_pause.config(state="normal", text="ì¼ì‹œì •ì§€")  # ì¼ì‹œì •ì§€ í™œì„±
            self.btn_reset.config(state="normal")  # ì´ˆê¸°í™” í™œì„±
            self.ent_minutes.config(state="disabled")  # ë¶„ ì…ë ¥ ì ê¸ˆ
            self.ent_warn.config(state="disabled")  # ê²½ê³  ì…ë ¥ ì ê¸ˆ
        else:  # ì •ì§€ ìƒíƒœ
            self.btn_start.config(state="normal")  # ì‹œì‘ í™œì„±í™”
            self.btn_pause.config(state="disabled", text="ì¼ì‹œì •ì§€")  # ì¼ì‹œì •ì§€ ë¹„í™œì„±
            self.btn_reset.config(state="disabled")  # ì´ˆê¸°í™” ë¹„í™œì„±
            self.ent_minutes.config(state="normal")  # ë¶„ ì…ë ¥ í—ˆìš©
            self.ent_warn.config(state="normal")  # ê²½ê³  ì…ë ¥ í—ˆìš©

    def _stop_tick_loop(self) -> None:  # íƒ€ì´ë¨¸ í‹± ë£¨í”„ ì¤‘ì§€
        """ì˜ˆì•½ëœ íƒ€ì´ë¨¸ í‹±(after) ë£¨í”„ë¥¼ ì•ˆì „í•˜ê²Œ ì·¨ì†Œ."""  # ì˜ˆì™¸ ì•ˆì „ì„± ì„¤ëª…
        if self._timer_after_id is not None:  # ì˜ˆì•½ ì¡´ì¬ ê²€ì‚¬
            try:
                self.after_cancel(self._timer_after_id)  # ì˜ˆì•½ ì·¨ì†Œ
            except Exception:
                pass  # New ì´ë¯¸ ë§Œë£Œ/ì·¨ì†Œëœ IDì¼ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì˜ˆì™¸ë¥¼ ë¬´ì‹œí•´ ì•ˆì „ì„± í™•ë³´
            self._timer_after_id = None  # ìƒíƒœ í´ë¦¬ì–´

    def _stop_blink(self) -> None:  # ê¹œë°•ì„ ì¤‘ì§€
        """íƒ€ì„ì—… ê¹œë°•ì„ ë£¨í”„ë¥¼ ì¤‘ì§€í•˜ê³  ê¸€ììƒ‰ì„ ì›ë˜ëŒ€ë¡œ ë³µì›."""  # ì‹œê° ìƒíƒœ ë³µì› ì„¤ëª…
        if self._blink_after_id is not None:  # ì˜ˆì•½ ì¡´ì¬ ê²€ì‚¬
            try:
                self.after_cancel(self._blink_after_id)  # ì˜ˆì•½ ì·¨ì†Œ
            except Exception:
                pass  # ì˜ˆì™¸ ë¬´ì‹œ
            self._blink_after_id = None  # ìƒíƒœ í´ë¦¬ì–´
        self._blink_on = False  # í† ê¸€ ë¦¬ì…‹
        self.lbl_timer.config(fg="black")  # ê¸€ììƒ‰ ë³µì›

    def _start_blink(self) -> None:  # ê¹œë°•ì„ ì‹œì‘
        """íƒ€ì„ì—… ì‹œ ë¹¨ê°•/ê²€ì •ì„ êµëŒ€ë¡œ ê¹œë°•ì´ë©° ì¢…ë£Œë¥¼ ê°•í•˜ê²Œ ì•Œë¦¼."""  # ì‚¬ìš©ì ì£¼ëª© ìœ ë„ ëª©ì 
        self._blink_on = not self._blink_on  # í† ê¸€ ë°˜ì „
        self.lbl_timer.config(fg=("red" if self._blink_on else "black"))  # ìƒ‰ìƒ í† ê¸€ ì ìš©
        self._blink_after_id = self.after(450, self._start_blink)  # New 0.45ì´ˆ ê°„ê²© â†’ ìê·¹ì€ ì£¼ë˜ ê³¼ë„í•˜ì§€ ì•Šê²Œ

    def start_timer(self) -> None:  # íƒ€ì´ë¨¸ ì‹œì‘ í•¸ë“¤ëŸ¬
        """ì…ë ¥ê°’ ê²€ì¦ í›„ íƒ€ì´ë¨¸ë¥¼ ì‹œì‘í•˜ê³  ì£¼ê¸° í‹± ë£¨í”„ë¥¼ ê°€ë™."""  # ë‹¨ê³„ë³„ ì²˜ë¦¬ ì„¤ëª…
        self._stop_tick_loop()  # ê¸°ì¡´ ë£¨í”„ ì¤‘ì§€
        self._stop_blink()  # ê¸°ì¡´ ê¹œë°• ì¤‘ì§€
        # 1) ë¶„ ì…ë ¥(ì‹¤ìˆ˜ í—ˆìš©)
        try:
            minutes = float(self.ent_minutes.get().strip())  # ë¶„ ì…ë ¥ íŒŒì‹±
        except Exception:
            messagebox.showerror("ì…ë ¥ ì˜¤ë¥˜", "ë°œí‘œ ì‹œê°„(ë¶„)ì„ ìˆ«ìë¡œ ì…ë ¥í•˜ì„¸ìš”. ì˜ˆ: 5 ë˜ëŠ” 7.5", parent=self)  # ì˜¤ë¥˜ ì•ˆë‚´
            self.ent_minutes.focus_set()  # í¬ì»¤ìŠ¤ ë³µêµ¬
            return  # ì¤‘ë‹¨
        if minutes <= 0:  # ìµœì†Œê°’ ê²€ì¦
            messagebox.showerror("ì…ë ¥ ì˜¤ë¥˜", "ë°œí‘œ ì‹œê°„(ë¶„)ì€ 0ë³´ë‹¤ ì»¤ì•¼ í•©ë‹ˆë‹¤.", parent=self)  # ì˜¤ë¥˜ ì•ˆë‚´
            self.ent_minutes.focus_set()  # í¬ì»¤ìŠ¤ ë³µêµ¬
            return  # ì¤‘ë‹¨
        # 2) ê²½ê³  ì„ê³„(ì •ìˆ˜)
        try:
            warn = int(self.ent_warn.get().strip())  # ì„ê³„ íŒŒì‹±
        except Exception:
            messagebox.showerror("ì…ë ¥ ì˜¤ë¥˜", "ê²½ê³  ì„ê³„(ì´ˆ)ë¥¼ ì •ìˆ˜ë¡œ ì…ë ¥í•˜ì„¸ìš”. ì˜ˆ: 30", parent=self)  # ì˜¤ë¥˜ ì•ˆë‚´
            self.ent_warn.focus_set()  # í¬ì»¤ìŠ¤ ë³µêµ¬
            return  # ì¤‘ë‹¨
        if warn < 1:  # ìµœì†Œ 1ì´ˆ ë³´ì¥
            messagebox.showerror("ì…ë ¥ ì˜¤ë¥˜", "ê²½ê³  ì„ê³„(ì´ˆ)ëŠ” 1ì´ˆ ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.", parent=self)  # ì˜¤ë¥˜ ì•ˆë‚´
            self.ent_warn.focus_set()  # í¬ì»¤ìŠ¤ ë³µêµ¬
            return  # ì¤‘ë‹¨

        # 3) ë‚´ë¶€ ìƒíƒœ ì…‹ì—…
        total_sec = int(round(minutes * 60))  # ë¶„â†’ì´ˆ í™˜ì‚°
        self.timer_total_sec = total_sec  # ì´ ì‹œê°„ ì €ì¥
        self.timer_warn_sec  = min(warn, max(1, total_sec - 1))  # New ê²½ê³  ì„ê³„ê°€ ì´ì‹œê°„ ì´ìƒì´ ë˜ì§€ ì•Šê²Œ ë³´ì •
        self.timer_running   = True  # ì‹¤í–‰ í”Œë˜ê·¸
        self.timer_end_mono  = time.monotonic() + self.timer_total_sec  # ì¢…ë£Œ ëª©í‘œ ì‹œê°
        self.timer_remain_sec = self.timer_total_sec  # ë‚¨ì€ ì‹œê°„ ì´ˆê¸°í™”

        # 4) UI ì´ˆê¸°í™”
        self.lbl_timer.config(text=self._format_sec(self.timer_remain_sec), fg="black")  # ì´ˆê¸° ë¼ë²¨/ìƒ‰
        self.pb_timer.config(maximum=self.timer_total_sec, value=0)  # ì§„í–‰ ë°” ì´ˆê¸°í™”
        self._set_timer_controls_running(True)  # ì»¨íŠ¸ë¡¤ ìƒíƒœ ì „í™˜

        # 5) í‹± ë£¨í”„ ì‹œì‘
        self._tick_update()  # ì£¼ê¸° ì—…ë°ì´íŠ¸ ê°€ë™

    def pause_resume_timer(self) -> None:  # ì¼ì‹œì •ì§€/ê³„ì† í† ê¸€
        """ì¼ì‹œì •ì§€/ê³„ì† í† ê¸€ â€” ë‚¨ì€ ì‹œê°„ì„ ì €ì¥/ë³µêµ¬í•˜ì—¬ ì •í™•ë„ ìœ ì§€."""  # ë¡œì§ ìš”ì•½
        if not self.timer_running:  # í˜„ì¬ ì •ì§€ ìƒíƒœë©´
            # ê³„ì†
            if self.timer_remain_sec <= 0:  # ì´ë¯¸ ì™„ë£Œëœ íƒ€ì´ë¨¸ë©´ ë¬´ì‹œ
                return  # ì¢…ë£Œ
            self.timer_end_mono = time.monotonic() + self.timer_remain_sec  # ëª©í‘œ ì‹œê° ì¬ì„¤ì •
            self.timer_running = True  # ì‹¤í–‰ ì¬ê°œ
            self.btn_pause.config(text="ì¼ì‹œì •ì§€")  # ë²„íŠ¼ ë¼ë²¨ ë³€ê²½
            self._tick_update()  # í‹± ë£¨í”„ ì¬ê°€ë™
            return  # ë°˜í™˜

        # ì¼ì‹œì •ì§€
        now_mono = time.monotonic()  # í˜„ì¬ ë‹¨ì¡° ì‹œê°
        remain = max(0, int(math.ceil(self.timer_end_mono - now_mono)))  # ë‚¨ì€ ì´ˆ ê³„ì‚°
        self.timer_remain_sec = remain  # ìƒíƒœ ë°˜ì˜
        self.timer_running = False  # ì •ì§€
        self.btn_pause.config(text="ê³„ì†")  # ë¼ë²¨ ë³€ê²½
        self._stop_tick_loop()  # ë£¨í”„ ì¤‘ì§€

    def reset_timer(self) -> None:  # ì´ˆê¸°í™” í•¸ë“¤ëŸ¬
        """íƒ€ì´ë¨¸ë¥¼ ì™„ì „íˆ ì´ˆê¸° ìƒíƒœë¡œ ë˜ëŒë¦¼(ë£¨í”„/ê¹œë°•ì„ í¬í•¨)."""  # ë¦¬ì…‹ ë²”ìœ„ ì„¤ëª…
        self.timer_running = False  # ì •ì§€
        self.timer_total_sec = 0  # ì´ ì‹œê°„ ë¦¬ì…‹
        self.timer_remain_sec = 0  # ë‚¨ì€ ì‹œê°„ ë¦¬ì…‹
        self.timer_end_mono = 0.0  # ëª©í‘œ ì‹œê° ë¦¬ì…‹
        self._stop_tick_loop()  # í‹± ë£¨í”„ ì¤‘ì§€
        self._stop_blink()  # ê¹œë°• ì¤‘ì§€
        self.lbl_timer.config(text="00:00", fg="black")  # ë¼ë²¨ ë¦¬ì…‹
        self.pb_timer.config(maximum=1, value=0)  # ë°” ë¦¬ì…‹
        self._set_timer_controls_running(False)  # ì»¨íŠ¸ë¡¤ ë¹„í™œì„±í™”

    def _on_time_up(self) -> None:  # íƒ€ì„ì—… ì²˜ë¦¬
        """ë‚¨ì€ ì‹œê°„ì´ 0ì´ ë˜ì—ˆì„ ë•Œ íƒ€ì„ì—… ì²˜ë¦¬(ì†Œë¦¬+ìƒ‰+ê¹œë°•ìœ¼ë¡œ ê°•í•œ ì‹ í˜¸)."""  # ì‚¬ìš©ì ì•Œë¦¼ ê°•í™”
        self.timer_running = False  # ì •ì§€
        self._stop_tick_loop()  # ë£¨í”„ ì¤‘ì§€
        self.lbl_timer.config(text="00:00", fg="red")  # ë¹¨ê°„ìƒ‰ 0ì´ˆ
        self.pb_timer.config(value=self.timer_total_sec)  # ì§„í–‰ ë°” ëê¹Œì§€
        try:
            self.bell()  # ì‹œìŠ¤í…œ ë²¨
        except Exception:
            pass  # ì¼ë¶€ í™˜ê²½ì—ì„œ ì‹œìŠ¤í…œ ë²¨ ì‹¤íŒ¨ ê°€ëŠ¥ â†’ ì¡°ìš©íˆ ë¬´ì‹œ
        self.btn_pause.config(state="disabled", text="ì¼ì‹œì •ì§€")  # ì¼ì‹œì •ì§€ ë²„íŠ¼ ë¹„í™œì„±í™”
        self._start_blink()  # ê¹œë°•ì„ ì‹œì‘

    def _tick_update(self) -> None:  # ì£¼ê¸° í‹± í•¨ìˆ˜
        """200ms ê°„ê²©ìœ¼ë¡œ ë‚¨ì€ ì‹œê°„ì„ ê°±ì‹ í•˜ê³ , ê²½ê³ /ì§„í–‰ë¥ /ì¢…ë£Œë¥¼ ì²˜ë¦¬."""  # ì£¼ê¸°/ì—­í•  ì„¤ëª…
        if not self.timer_running:  # ì •ì§€ ìƒíƒœë©´
            return  # ê°±ì‹  ì¤‘ë‹¨
        now_mono = time.monotonic()  # í˜„ì¬ ë‹¨ì¡° ì‹œê°
        remain = int(max(0, math.ceil(self.timer_end_mono - now_mono)))  # ë‚¨ì€ ì´ˆ ê³„ì‚°(ì˜¬ë¦¼)
        self.timer_remain_sec = remain  # ìƒíƒœ ë°˜ì˜
        self.lbl_timer.config(text=self._format_sec(remain))  # ë¼ë²¨ ê°±ì‹ 
        if remain == 0:  # ì¢…ë£Œ ì‹œì 
            self._on_time_up()  # íƒ€ì„ì—… ì²˜ë¦¬
            return  # ë£¨í”„ ì¢…ë£Œ
        elif remain <= self.timer_warn_sec:  # ê²½ê³  êµ¬ê°„ ì§„ì…
            self.lbl_timer.config(fg="orange")  # ì£¼í™©ìƒ‰ í‘œì‹œ
        else:  # ì •ìƒ êµ¬ê°„
            self.lbl_timer.config(fg="black")  # ê²€ì • í‘œì‹œ
        done = self.timer_total_sec - remain  # ê²½ê³¼ ì´ˆ
        self.pb_timer.config(value=done)  # ì§„í–‰ ë°” ê°±ì‹ 
        self._timer_after_id = self.after(200, self._tick_update)  # ë‹¤ìŒ í‹± ì˜ˆì•½
        # New 200msë©´ ì¶©ë¶„íˆ ë¶€ë“œëŸ½ê³ , CPU ì†Œëª¨ë„ ê³¼í•˜ì§€ ì•Šì€ íƒ€í˜‘ê°’.

    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    # ë¦¬í¬íŠ¸ ë¡œì§(ì§‘ê³„/ì‹œê°í™”/ì˜¤í† ë£¨í”„/ë§ˆì¼ìŠ¤í†¤ ì»¨í˜í‹°)            # ëŒ€ì‹œë³´ë“œ ì—”ì§„
    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    def _stop_report_loop(self) -> None:  # ë¦¬í¬íŠ¸ ë£¨í”„ ì¤‘ì§€
        """ë¦¬í¬íŠ¸ ìë™ ê°±ì‹ (after) ì˜ˆì•½ì´ ìˆìœ¼ë©´ ì·¨ì†Œí•˜ì—¬ ì¤‘ë³µ ë£¨í”„ë¥¼ ë°©ì§€."""  # ì¤‘ë³µ ë°©ì§€ ì„¤ëª…
        if self._report_after_id:  # ì˜ˆì•½ ì¡´ì¬ ê²€ì‚¬
            try:
                self.after_cancel(self._report_after_id)  # ì˜ˆì•½ ì·¨ì†Œ
            except Exception:
                pass  # ì˜ˆì™¸ ë¬´ì‹œ
            self._report_after_id = None  # ìƒíƒœ í´ë¦¬ì–´
        # New ë¦¬ìŠ¤íŠ¸ ê°±ì‹ /íƒ­ ì´ˆê¸°í™” ë“±ì—ì„œ refresh_reportë¥¼ ë‹¤ì‹œ ë¶€ë¥¼ ë•Œ ì¤‘ë³µ ì˜ˆì•½ì„ ì˜ˆë°©.

    def calc_report_stats(self) -> dict:  # ì§‘ê³„ í•¨ìˆ˜
        """self.todosë¥¼ ì§‘ê³„í•´ ë¦¬í¬íŠ¸ìš© ìš”ì•½ ì§€í‘œë¥¼ ê³„ì‚°."""  # ì§€í‘œ ì •ì˜ ì„¤ëª…
        total = len(self.todos)  # ì´ ê°œìˆ˜
        if total == 0:  # ë¹„ì–´ìˆì„ ë•Œ
            # New ë¹ˆ ë¦¬ìŠ¤íŠ¸ì¼ ë•Œë„ UIê°€ ì•ˆì •ì ìœ¼ë¡œ ë Œë”ë˜ë„ë¡ 0/ë¹ˆ ë°°ì—´ì„ ë°˜í™˜
            return {"rate": 0.0, "avg_days": 0.0, "soon": 0, "overdue": 0,
                    "counts": (0, 0, 0), "week_bins": [0]*7}  # ê¸°ë³¸ êµ¬ì¡° ë°˜í™˜

        # ìƒíƒœë³„ ê°œìˆ˜
        cnt0 = sum(1 for t in self.todos if t.status == 0)  # ë¯¸ì™„
        cnt1 = sum(1 for t in self.todos if t.status == 1)  # ì§„í–‰
        cnt2 = sum(1 for t in self.todos if t.status == 2)  # ì™„ë£Œ
        rate = round(cnt2 / total * 100, 1)                 # ì™„ë£Œìœ¨(ì†Œìˆ˜ 1ìë¦¬)

        today = date.today()  # ì˜¤ëŠ˜ ë‚ ì§œ
        start_week = today - timedelta(days=today.weekday())  # New ì´ë²ˆ ì£¼ì˜ ì›”ìš”ì¼(week anchor)
        soon = 0       # 3ì¼ ì´ë‚´ ë§ˆê°(ë¯¸ì™„/ì§„í–‰ë§Œ)
        overdue = 0    # ë§ˆê°ì´ ì§€ë‚œ í•­ëª©(ë¯¸ì™„/ì§„í–‰ë§Œ)
        durations: list[int] = []  # (ì¢…ë£Œ-ì‹œì‘) ì¼ìˆ˜
        week_bins = [0]*7          # ì›”(0)~ì¼(6) ë§ˆê° ê±´ìˆ˜

        for t in self.todos:  # í•­ëª© ìˆœíšŒ
            try:
                d1 = parse_date(t.start).date()  # ì‹œì‘ì¼ íŒŒì‹±
                d2 = parse_date(t.end).date()    # ì¢…ë£Œì¼ íŒŒì‹±
            except Exception:
                continue  # ì˜ëª»ëœ ë‚ ì§œëŠ” ìŠ¤í‚µ(ë¦¬í¬íŠ¸ê°€ ì „ì²´ ì‹¤íŒ¨ë¡œ ì´ì–´ì§€ì§€ ì•Šë„ë¡ ë³´í˜¸)

            if d2 >= d1:  # ìŒìˆ˜ ê¸°ê°„ ë°©ì§€
                durations.append((d2 - d1).days)  # ê¸°ê°„ ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€
            delta = (d2 - today).days  # ì˜¤ëŠ˜ ê¸°ì¤€ ì”ì—¬ ì¼ìˆ˜
            if t.status != 2 and 0 <= delta <= 3:  # ì™„ë£Œ ì œì™¸ + 3ì¼ ì´ë‚´
                soon += 1  # ì„ë°•++
            if t.status != 2 and delta < 0:  # ì™„ë£Œ ì œì™¸ + ë§ˆê° ì´ˆê³¼
                overdue += 1  # ì§€ë‚¨++
            off = (d2 - start_week).days  # ì´ë²ˆì£¼ offset
            if 0 <= off < 7:  # ì´ë²ˆ ì£¼ ë²”ìœ„ ë‚´
                week_bins[off] += 1  # í•´ë‹¹ ìš”ì¼ ì¹´ìš´íŠ¸

        avg_days = round(sum(durations)/len(durations), 1) if durations else 0.0  # í‰ê·  ê¸°ê°„ ê³„ì‚°
        return {"rate": rate, "avg_days": avg_days, "soon": soon, "overdue": overdue,
                "counts": (cnt0, cnt1, cnt2), "week_bins": week_bins}  # ì§‘ê³„ ê²°ê³¼ ë°˜í™˜
        # New ì„ë°•/ì§€ë‚¨ì€ â€œì™„ë£Œë˜ì§€ ì•Šì€ í•­ëª©â€ë§Œ ëŒ€ìƒìœ¼ë¡œ ê³„ì‚° â†’ ê´€ë¦¬ í¬ì¸íŠ¸ë§Œ ë¶€ê°.

    def refresh_report(self) -> None:  # ë¦¬í¬íŠ¸ ê°±ì‹  ë£¨í‹´
        """ë¦¬í¬íŠ¸ í…ìŠ¤íŠ¸/KPIì™€ ì‹œê°í™”ë¥¼ ê°±ì‹ í•˜ê³ , 5ì´ˆ í›„ ë‹¤ì‹œ ìì‹ ì„ ì˜ˆì•½."""  # ì˜¤í† ë£¨í”„ ì„¤ëª…
        self._stop_report_loop()  # ì¤‘ë³µ ë£¨í”„ ë°©ì§€
        s = self.calc_report_stats()  # ì§‘ê³„ ìˆ˜í–‰

        # í…ìŠ¤íŠ¸ KPI
        self.lbl_rate.config(text=f"ì™„ë£Œìœ¨ {s['rate']:.1f}%")  # ì™„ë£Œìœ¨ í‘œì‹œ
        self.var_avg.set (f"í‰ê·  ê¸°ê°„: {s['avg_days']}ì¼")  # í‰ê·  ê¸°ê°„ í‘œì‹œ
        self.var_soon.set(f"ë§ˆê° ì„ë°•: {s['soon']}ê±´")  # ì„ë°• í‘œì‹œ
        self.var_over.set(f"ì§€ë‚¨: {s['overdue']}ê±´")  # ì§€ë‚¨ í‘œì‹œ
        c0, c1, c2 = s["counts"]  # ìƒíƒœ íŠœí”Œ ì–¸íŒ©
        self.var_counts.set(f"ìƒíƒœ êµ¬ì„±: ë¯¸ì™„ {c0} Â· ì§„í–‰ {c1} Â· ì™„ë£Œ {c2}")  # ìƒíƒœ êµ¬ì„± í‘œì‹œ

        # ìƒ‰ìƒ í”¼ë“œë°±(í…ìŠ¤íŠ¸/ë„ë„› ìƒ‰ ê·œì¹™ì„ í†µì¼)
        col = self._rate_color(s["rate"])  # ê·œì¹™ ê¸°ë°˜ ìƒ‰ìƒ
        self.lbl_rate.config(foreground=col)  # ë ˆì´ë¸” ìƒ‰ìƒ ì ìš©

        # ì‹œê°í™”(ë„ë„› ì• ë‹ˆë©”ì´ì…˜, ìƒíƒœ ìŠ¤íƒë°”, ì£¼ê°„ íˆíŠ¸ë§µ)
        self._animate_ring_to(s["rate"])   # New ë¯¸ì„¸ ë³€í™”(<0.2%)ëŠ” ì¦‰ì‹œ, ê·¸ ì™¸ëŠ” ë³´ê°„ ì• ë‹ˆ
        self._draw_stack(s["counts"])  # ìŠ¤íƒë°” ë Œë”
        self._draw_heat(s["week_bins"])  # íˆíŠ¸ë§µ ë Œë”

        # ë§ˆì¼ìŠ¤í†¤ ì»¨í˜í‹°(ì²« ê°±ì‹  ì œì™¸, 50/80/100 ìƒí–¥ ëŒíŒŒ ì‹œ)
        prev = self._last_rate  # ì´ì „ ì™„ë£Œìœ¨
        if self._report_booted and any(prev < m <= s["rate"] for m in (50, 80, 100)):  # ë§ˆì¼ìŠ¤í†¤ ëŒíŒŒ íŒë‹¨
            self._burst_confetti(duration=800)  # 0.8ì´ˆ ì§§ì€ ë³´ìƒ ì• ë‹ˆë©”ì´ì…˜
        self._report_booted = True  # ì²« ê°±ì‹  ì´í›„ë¡œ ì „í™˜
        self._last_rate = s["rate"]  # í˜„ì¬ ì™„ë£Œìœ¨ ì €ì¥

        # ë‹¤ìŒ ìë™ ê°±ì‹  ì˜ˆì•½(5ì´ˆ)
        self._report_after_id = self.after(5000, self.refresh_report)  # ìê¸° ì¬í˜¸ì¶œ ì˜ˆì•½
        # New ë¦¬ìŠ¤íŠ¸ ë³€ë™ì´ ì¦ì•„ë„ ë¹„ìš©ì´ ë‚®ì€ ì§‘ê³„/ë“œë¡œì‰ë§Œ ìˆ˜í–‰ â†’ UI ë°˜ì‘ì„± ìœ ì§€.

    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    # New ìƒ‰ìƒ/ë„ë„›/ìŠ¤íƒë°”/íˆíŠ¸ë§µ/ì»¨í˜í‹° ë“œë¡œì‰ ìœ í‹¸              # ì‹œê°í™” ìœ í‹¸ ëª¨ë“ˆ
    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    def _rate_color(self, rate: float) -> str:  # ìƒ‰ìƒ ê²°ì • í•¨ìˆ˜
        """New ì™„ë£Œìœ¨(%)ì— ë”°ë¥¸ ì‹œê·¸ë„ ìƒ‰ì„ ë°˜í™˜: <50 ë¹¨ê°•, <80 ì£¼í™©, ê·¸ ì™¸ ì´ˆë¡."""  # ìƒ‰ìƒ êµ¬ê°„ ê·œì¹™
        return "#e53935" if rate < 50 else "#fb8c00" if rate < 80 else "#43a047"  # ì‚¼í•­ìœ¼ë¡œ ê°„ê²° ì²˜ë¦¬

    def _draw_ring(self, rate: float) -> None:  # ë„ë„› ë Œë” í•¨ìˆ˜
        """ì™„ë£Œìœ¨(0~100)ì„ ë„ë„› í˜•íƒœë¡œ ê·¸ë¦°ë‹¤(ë² ì´ìŠ¤ ë§+ì§„í–‰ ì•„í¬+ì¤‘ì•™ í¼ì„¼íŠ¸)."""  # ìš”ì†Œ êµ¬ì„± ì„¤ëª…
        c = self.cnv_ring  # ëŒ€ìƒ ìº”ë²„ìŠ¤ ë‹¨ì¶• ì°¸ì¡°
        c.delete("all")  # ì´ì „ í”„ë ˆì„ ì§€ìš°ê¸°
        cx, cy, r, th = 80, 80, 70, 14  # ì¤‘ì‹¬/ë°˜ì§€ë¦„/ë‘ê»˜ íŒŒë¼ë¯¸í„°
        # ë² ì´ìŠ¤(íšŒìƒ‰ ë§)
        c.create_oval(cx - r, cy - r, cx + r, cy + r, outline="#e6e6e6", width=th)  # ë°”íƒ• ë§
        # ì§„í–‰ ì•„í¬(12ì‹œ ë°©í–¥ì—ì„œ ì‹œê³„ë°©í–¥ìœ¼ë¡œ ì±„ì›€)
        col = self._rate_color(rate)  # ë¹„ìœ¨ì— ë”°ë¥¸ ìƒ‰ìƒ
        extent = 360 * (rate / 100)  # ê°ë„(0~360)
        c.create_arc(cx - r, cy - r, cx + r, cy + r, start=90, extent=-extent,
                     style="arc", width=th, outline=col)  # ì§„í–‰ ì•„í¬(ì‹œê³„ë°©í–¥)
        # ì¤‘ì•™ í¼ì„¼íŠ¸ ë¼ë²¨
        c.create_text(cx, cy, text=f"{rate:.1f}%", font=("Helvetica", 16, "bold"))  # í¼ì„¼íŠ¸ í…ìŠ¤íŠ¸

    def _animate_ring_to(self, target: float) -> None:  # ë„ë„› ì• ë‹ˆ í•¨ìˆ˜
        """ì™„ë£Œìœ¨ ë³€í™”ëŸ‰ì— ë”°ë¼ ë„ë„›ì„ ë¶€ë“œëŸ½ê²Œ ë³´ê°„ ë Œë”(ì•„ì£¼ ì‘ìœ¼ë©´ ì¦‰ì‹œ ë°˜ì˜)."""  # ì• ë‹ˆ ì •ì±… ì„¤ëª…
        start = getattr(self, "_ring_anim_start", self._last_rate)  # ì‹œì‘ê°’(ì—†ìœ¼ë©´ ë§ˆì§€ë§‰ ì™„ë£Œìœ¨)
        if abs(target - start) < 0.2:     # New 0.2% ë¯¸ë§Œ ë³€í™”ëŠ” ëˆˆì— ì•ˆ ë„ë¯€ë¡œ ë°”ë¡œ ê·¸ë¦¼
            self._draw_ring(target)  # ì¦‰ì‹œ ë Œë”
            self._ring_anim_start = target  # ìƒíƒœ ì €ì¥
            return  # ì¢…ë£Œ
        steps = max(8, int(abs(target - start) // 2))  # ë³€í™”í­ì— ë¹„ë¡€í•œ ìŠ¤í… ìˆ˜(í•˜í•œ 8)
        def step(i=0):  # ë‚´ë¶€ ìŠ¤í… í•¨ìˆ˜
            val = start + (target - start) * i / steps  # ì„ í˜• ë³´ê°„
            self._draw_ring(val)  # ì¤‘ê°„ê°’ ë Œë”
            if i < steps:  # ë‹¤ìŒ ìŠ¤í… ì¡´ì¬
                self.after(16, step, i + 1)  # ì•½ 60fps
            else:  # ë§ˆì§€ë§‰ ìŠ¤í…
                self._ring_anim_start = target  # ìƒíƒœ ì €ì¥
        step()  # ì• ë‹ˆ ì‹œì‘

    def _draw_stack(self, counts: tuple[int, int, int]) -> None:  # ìŠ¤íƒë°” ë Œë” í•¨ìˆ˜
        """ìƒíƒœ êµ¬ì„±(ë¯¸ì™„/ì§„í–‰/ì™„ë£Œ)ì„ ê°€ë¡œ ìŠ¤íƒë°”ë¡œ ì‹œê°í™”."""  # ì…ë ¥/í‘œí˜„ ì„¤ëª…
        c = self.cnv_stack  # ëŒ€ìƒ ìº”ë²„ìŠ¤
        c.delete("all")  # ì´ˆê¸°í™”
        w = c.winfo_width() or 400  # í˜„ì¬ í­(ë ˆì´ì•„ì›ƒ ì´ˆê¸°ì—” 0ì¼ ìˆ˜ ìˆì–´ ê¸°ë³¸ê°’ 400)
        h = 22  # ê³ ì • ë†’ì´
        total = max(1, sum(counts))  # 0ë¶„ëª¨ ë°©ì§€
        colors = ["#90a4ae", "#fb8c00", "#43a047"]  # ë¯¸ì™„/ì§„í–‰/ì™„ë£Œ ìƒ‰
        x = 0  # ëˆ„ì  X ì‹œì‘ì 
        for n, col in zip(counts, colors):  # êµ¬ê°„ ë Œë”
            seg = int(w * n / total)  # êµ¬ê°„ ê¸¸ì´
            c.create_rectangle(x, 0, x + seg, h, fill=col, width=0)  # êµ¬ê°„ ë°•ìŠ¤
            x += seg  # ë‹¤ìŒ ì‹œì‘ì  ì´ë™
        c.create_rectangle(0, 0, w, h, outline="#d0d0d0")  # ì™¸ê³½ì„ ìœ¼ë¡œ ë°” ê²½ê³„ ëª…í™•í™”

    def _draw_heat(self, bins: list[int]) -> None:  # íˆíŠ¸ë§µ ë Œë” í•¨ìˆ˜
        """ì´ë²ˆ ì£¼(ì›”~ì¼) ë§ˆê° ê±´ìˆ˜ë¥¼ ì—°ë…¹â†’ì§„ë…¹ ê·¸ë¼ë°ì´ì…˜ìœ¼ë¡œ íˆíŠ¸ë§µ í‘œì‹œ."""  # ìƒ‰/ì˜ë¯¸ ì„¤ëª…
        c = self.cnv_heat  # ëŒ€ìƒ ìº”ë²„ìŠ¤
        c.delete("all")  # ì´ˆê¸°í™”
        w = c.winfo_width() or 420  # í˜„ì¬ í­(ë ˆì´ì•„ì›ƒ ì´ˆê¸° ë³´ì •)
        h = 56  # ê³ ì • ë†’ì´
        cell = w // 7  # í•˜ë£¨ë‹¹ ì¹¸ í­
        pad = 4  # ì¹¸ ë‚´ë¶€ íŒ¨ë”©
        days = ["ì›”", "í™”", "ìˆ˜", "ëª©", "ê¸ˆ", "í† ", "ì¼"]  # ìš”ì¼ ë¼ë²¨
        mx = max(bins) or 1  # ìµœëŒ€ê°’ 0ì¼ ë•Œ 0ìœ¼ë¡œ ë‚˜ëˆ„ê¸° ë°©ì§€
        def blend(a: str, b: str, t: float) -> str:  # ìƒ‰ ë³´ê°„ ìœ í‹¸
            """hex ìƒ‰ìƒ aâ†’b ì‚¬ì´ë¥¼ t(0~1)ë¡œ ë³´ê°„í•˜ì—¬ hexë¡œ ë°˜í™˜."""  # ë³´ê°„ ê·œì¹™ ì„¤ëª…
            ah, ag, ab = int(a[1:3], 16), int(a[3:5], 16), int(a[5:7], 16)  # ìƒ‰ìƒ a ë¶„í•´
            bh, bg, bb = int(b[1:3], 16), int(b[3:5], 16), int(b[5:7], 16)  # ìƒ‰ìƒ b ë¶„í•´
            ih, ig, ib = int(ah + (bh - ah) * t), int(ag + (bg - ag) * t), int(ab + (bb - ab) * t)  # ë³´ê°„
            return f"#{ih:02x}{ig:02x}{ib:02x}"  # ë³´ê°„ ê²°ê³¼ hex
        for i, v in enumerate(bins):  # 7ì¼ ìˆœíšŒ
            x0, x1 = i * cell + pad, (i + 1) * cell - pad  # X ì˜ì—­
            y0, y1 = pad, h - 18  # Y ì˜ì—­
            col = blend("#e8f5e9", "#1b5e20", v / mx)  # ì—°ë…¹â†’ì§„ë…¹ ë§¤í•‘
            c.create_rectangle(x0, y0, x1, y1, fill=col, outline="#cfd8dc")  # ì¹¸ ë Œë”
            c.create_text((x0 + x1) // 2, h - 8, text=days[i], font=("Helvetica", 9))  # ìš”ì¼ ë¼ë²¨
        # New ìˆ˜ì¹˜ ë¼ë²¨ ì—†ì´ë„ 'ë†ë„'ë¡œ í”¼í¬ ìš”ì¼ì„ ì§ê´€ì ìœ¼ë¡œ íŒŒì•… ê°€ëŠ¥.

    def _burst_confetti(self, n: int = 28, duration: int = 800) -> None:  # ì»¨í˜í‹° ì—°ì¶œ í•¨ìˆ˜
        """New ë„ë„› ìº”ë²„ìŠ¤ ìœ„ì—ì„œë§Œ 0.8ì´ˆê°„ ì»¨í˜í‹°ë¥¼ ë–¨ì–´ëœ¨ë ¤(ì˜¤ë²„ë ˆì´ ì—†ì´) ì‹œê°ì  ë³´ìƒì„ ì œê³µ."""  # ëª©ì /ë²”ìœ„ ì„¤ëª…
        c = self.cnv_ring  # íˆ¬ëª… ì˜¤ë²„ë ˆì´ë¥¼ ì“°ì§€ ì•Šê¸° ìœ„í•´ ëŒ€ìƒ ìº”ë²„ìŠ¤(ë„ë„›)ì— ì§ì ‘ ê·¸ë¦¼
        import random as _r, time as _t  # ì§€ì—­ ì„í¬íŠ¸(ì „ì—­ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ì˜¤ì—¼ ë°©ì§€)
        W = c.winfo_width() or 160  # ìº”ë²„ìŠ¤ í­(ì´ˆê¸°ê°’ ë³´ì •)
        parts = []  # íŒŒí¸ ê°ì²´ ID ë³´ê´€ ë¦¬ìŠ¤íŠ¸
        pal = ["#43a047", "#1e88e5", "#fdd835", "#e53935", "#8e24aa"]  # íŒ”ë ˆíŠ¸(ì´ˆë¡/íŒŒë‘/ë…¸ë‘/ë¹¨ê°•/ë³´ë¼)
        # íŒŒí¸ ìƒì„±(ì‘ì€ ì›)
        for _ in range(n):  # nê°œ ìƒì„±
            x = _r.randint(0, max(8, W - 8))  # ì‹œì‘ X(í™”ë©´ í­ ë‚´ ëœë¤)
            y = -_r.randint(0, 40)  # ì‹œì‘ Y(ìƒë‹¨ ë°”ê¹¥ì—ì„œ ì§„ì…)
            s = _r.randint(4, 8)  # ì§€ë¦„(4~8)
            col = _r.choice(pal)  # ìƒ‰ìƒ ëœë¤ ì„ íƒ
            parts.append(c.create_oval(x, y, x + s, y + s, fill=col, width=0))  # ì› íŒŒí¸ ìƒì„±
        t0 = _t.monotonic()  # ì‹œì‘ ì‹œê°(ëª¨ë…¸í† ë‹‰)
        # ê°„ë‹¨í•œ ë‚™í•˜ ì• ë‹ˆë©”ì´ì…˜(ìˆ˜ì§ ì´ë™)
        def tick():  # í”„ë ˆì„ í•¨ìˆ˜
            dt = (_t.monotonic() - t0) * 1000.0  # ê²½ê³¼(ms)
            for p in parts:  # ëª¨ë“  íŒŒí¸ ì´ë™
                c.move(p, 0, 6)  # ì•„ë˜ë¡œ ê³ ì • ì†ë„ ë‚™í•˜
            if dt < duration:  # ì•„ì§ ì§€ì† ì‹œê°„ ë‚´
                c.after(16, tick)  # ì•½ 60fpsë¡œ ë‹¤ìŒ í”„ë ˆì„ ì˜ˆì•½
            else:  # ì‹œê°„ ë§Œë£Œ
                for p in parts:  # ëª¨ë“  íŒŒí¸
                    c.delete(p)  # ì‚­ì œí•´ ì”ìƒ/ë¦¬ì†ŒìŠ¤ ëˆ„ìˆ˜ ë°©ì§€
        tick()  # ì²« í”„ë ˆì„ í˜¸ì¶œ
        # New TkëŠ” ìº”ë²„ìŠ¤ bgì˜ 'ì™„ì „ íˆ¬ëª…'ì„ ì§€ì›í•˜ì§€ ì•Šì•„ ë¹ˆ ë¬¸ìì—´/íˆ¬ëª… ì»¬ëŸ¬ ì§€ì • ì‹œ ì˜¤ë¥˜ê°€ ë‚˜ë¯€ë¡œ,
        # New ë³„ë„ ì˜¤ë²„ë ˆì´ ìº”ë²„ìŠ¤ ì—†ì´ ë„ë„› ìº”ë²„ìŠ¤ì— ì§ì ‘ ê·¸ë ¤ ì•ˆì •ì ìœ¼ë¡œ ì—°ì¶œí•œë‹¤.

    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    # ì¢…ë£Œ ì²˜ë¦¬(ì•ˆì „ ì •ë¦¬)                                      # ì¢…ë£Œ ì‹œí€€ìŠ¤
    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    def _on_close(self) -> None:  # ë‹«ê¸° í•¸ë“¤ëŸ¬
        """ì˜ˆì•½ëœ after ë£¨í”„(íƒ€ì´ë¨¸/ê¹œë°•/ë¦¬í¬íŠ¸)ë¥¼ ëª¨ë‘ ì·¨ì†Œí•˜ê³  ì°½ì„ ë‹«ëŠ”ë‹¤."""  # ì•ˆì „ ì¢…ë£Œ ì„¤ëª…
        self._stop_tick_loop()  # íƒ€ì´ë¨¸ ë£¨í”„ ì •ì§€
        self._stop_blink()  # ê¹œë°•ì„ ë£¨í”„ ì •ì§€
        self._stop_report_loop()  # ë¦¬í¬íŠ¸ ë£¨í”„ ì •ì§€
        self.destroy()  # ì°½ íŒŒê´´(í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ)
        # New after ì½œë°±ì´ ë‚¨ì•„ìˆëŠ” ìƒíƒœë¡œ ì¢…ë£Œí•˜ë©´ ì˜ˆì™¸ê°€ ë‚  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ë°˜ë“œì‹œ ì„  ì •ë¦¬

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ì‹¤í–‰ ì—”íŠ¸ë¦¬í¬ì¸íŠ¸                                           # main guard
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
if __name__ == "__main__":  # ì´ íŒŒì¼ì„ ì§ì ‘ ì‹¤í–‰í•  ë•Œë§Œ ì•„ë˜ ì½”ë“œ ì‹¤í–‰
    app = TodoApp()   # ìµœìƒìœ„ ì•± ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
    app.mainloop()    # Tk ì´ë²¤íŠ¸ ë£¨í”„ ì‹œì‘(ì‚¬ìš©ì ì¸í„°ë™ì…˜ ì²˜ë¦¬)
